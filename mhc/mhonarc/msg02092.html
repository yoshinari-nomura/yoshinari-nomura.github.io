<!-- MHonArc v2.6.16 -->
<!--X-Subject: [mhc:02093] Re: patch for X&#45;SC&#45;Priority -->
<!--X-From-R13: @AUGQVW Khfhxr <abthabthNzin.ovtybor.ar.wc> -->
<!--X-Date: Sun, 10 Apr 2005 23:53:56 +0900 (JST) -->
<!--X-Message-Id: 20050410.235356.68558857.nogunogu@mva.biglobe.ne.jp -->
<!--X-Content-Type: multipart/mixed -->
<!--X-Reference: 20050408.201035.24460203.nogunogu@mva.biglobe.ne.jp -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>[mhc:02093] Re: patch for X-SC-Priority</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg02091.html">Date Prev</a>][<a href="msg02093.html">Date Next</a>][<a href="msg02091.html">Thread Prev</a>][<a href="msg02098.html">Thread Next</a>][<a href="maillist.html#02092">Date Index</a>][<a href="threads.html#02092">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[mhc:02093] Re: patch for X-SC-Priority</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:mhc@DOMAIN.HIDDEN">mhc@xxxxxxxxxxxxx</a></li>
<li><em>Subject</em>: [mhc:02093] Re: patch for X-SC-Priority</li>
<li><em>From</em>: NOGUCHI Yusuke &lt;<a href="mailto:nogunogu@DOMAIN.HIDDEN">nogunogu@xxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Sun, 10 Apr 2005 23:53:56 +0900 (JST)</li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:20050408.201035.24460203.nogunogu@DOMAIN.HIDDEN">20050408.201035.24460203.nogunogu@xxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>References</em>: &lt;<a href="mailto:20050408.201035.24460203.nogunogu@DOMAIN.HIDDEN">20050408.201035.24460203.nogunogu@xxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Reply-to</em>: <a href="mailto:mhc@DOMAIN.HIDDEN">mhc@xxxxxxxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>&#x91CE;&#x53E3;&#x3067;&#x3059;&#x3002;

X-SC-Priority &#x307E;&#x308F;&#x308A;&#x3092;&#x8272;&#x3005;&#x3044;&#x3058;&#x3063;&#x3066;&#x3044;&#x3066;&#x601D;&#x3046;&#x3068;&#x3053;&#x308D;&#x304C;&#x3042;&#x308A;&#x307E;&#x3057;&#x305F;&#x306E;&#x3067;&#x3001;&#x63D0;&#x6848;
&#x3044;&#x305F;&#x3057;&#x307E;&#x3059;&#x3002;

&#x73FE;&#x5728;&#x306E;&#x4F7F;&#x7528;&#x3067;&#x306F; X-SC-Priority &#x306E;&#x5024;&#x306F; 0&#x301C;100 &#x306E;&#x9593;&#x3067;&#x5165;&#x529B;&#x30FB;&#x8A2D;&#x5B9A;&#x3059;&#x308B;&#x3088;&#x3046;&#x306B;
&#x306A;&#x3063;&#x3066;&#x3044;&#x308B;&#x3088;&#x3046;&#x306A;&#x306E;&#x3067;&#x3059;&#x304C;&#x3001;&#x7C92;&#x5EA6;&#x304C;&#x7D30;&#x304B;&#x3059;&#x304E;&#x3066;&#x79C1;&#x306B;&#x306F;&#x304B;&#x3048;&#x3063;&#x3066;&#x4F7F;&#x3044;&#x306B;&#x304F;&#x304F;&#x611F;&#x3058;
&#x307E;&#x3057;&#x305F;&#x3002;&#x307E;&#x305F;&#x3001;summary &#x3067;&#x306E;&#x8868;&#x793A;&#x3082;&#x8A2D;&#x5B9A;&#x5024;&#x304C;&#x305D;&#x306E;&#x307E;&#x307E;&#x898B;&#x3048;&#x3066;&#x3057;&#x307E;&#x3046;&#x306E;&#x3082;&#x76F4;&#x611F;&#x7684;
&#x306B;&#x308F;&#x304B;&#x308A;&#x306B;&#x304F;&#x3044;&#x3088;&#x3046;&#x306B;&#x601D;&#x3044;&#x307E;&#x3057;&#x305F;&#x3002;

&#x500B;&#x4EBA;&#x7684;&#x306B;&#x306F;&#x3001; high, middle, low &#x306E;3&#x6BB5;&#x968E;&#x3067;&#x8A2D;&#x5B9A;&#x30FB;&#x8868;&#x793A;&#x3067;&#x304D;&#x308C;&#x3070;&#x5341;&#x5206;&#x3067;&#x3057;&#x305F;&#x306E;
&#x3067;&#x3001;&#x6DFB;&#x4ED8;&#x306E;&#x3088;&#x3046;&#x306B;&#x5909;&#x66F4;&#x3057;&#x3066;&#x307F;&#x307E;&#x3057;&#x305F;&#x3002;
(&#x73FE;&#x72B6;&#x306E;mhc &#x3067;&#x3082; 0&#x301C;49=&gt;low, 50&#x301C;79=&gt;middle, 80&#x301C;=&gt;high&#x3068;3&#x6BB5;&#x968E;&#x3067; face
&#x3092;&#x5909;&#x3048;&#x3066;&#x3044;&#x308B;&#x3068;&#x7406;&#x89E3;&#x3057;&#x3066;&#x3044;&#x307E;&#x3059;)

&#x5909;&#x6570; mhc-summary-display-priority-schema &#x3092;&#x4EE5;&#x4E0B;&#x306E;&#x3088;&#x3046;&#x306B;&#x8A2D;&#x5B9A;&#x3059;&#x308B;&#x3053;&#x3068;&#x3067;&#x3001;
&#x8A2D;&#x5B9A;&#x30FB;&#x8868;&#x793A;&#x65B9;&#x6CD5;&#x3092;&#x5909;&#x66F4;&#x3057;&#x307E;&#x3059;

 value        &#x2192; &#x5024;&#x3092;&#x305D;&#x306E;&#x307E;&#x307E;&#x8A2D;&#x5B9A;&#x30FB;&#x8868;&#x793A; (&#x3053;&#x308C;&#x307E;&#x3067;&#x901A;&#x308A;,&#x30C7;&#x30D5;&#x30A9;&#x30EB;&#x30C8;&#x5024;)
 three-level&#x3000;&#x2192; High, Middle, Low &#x306E;3&#x6BB5;&#x968E;&#x3067;&#x8A2D;&#x5B9A;&#x30FB;&#x8868;&#x793A;
 nine-level   &#x2192; A1,A2,A3,B1,B2,B3,C1,C2,C3&#x306E;9&#x6BB5;&#x968E;&#x3067;&#x8A2D;&#x5B9A;&#x30FB;&#x8868;&#x793A;


&#x6DFB;&#x4ED8;&#x5206;&#x306B;&#x306F;&#x3001;[mhc:02090]&#x3068;[mhc:02092]&#x3067;&#x63D0;&#x6848;&#x3057;&#x305F; patch &#x3082;&#x542B;&#x307E;&#x308C;&#x3066;&#x304A;&#x308A;&#x307E;&#x3059;&#x3002;

&#x4EE5;&#x4E0A;&#x3001;&#x3054;&#x691C;&#x8A0E;&#x3044;&#x305F;&#x3060;&#x3051;&#x308C;&#x3070;&#x5E78;&#x3044;&#x3067;&#x3059;&#x3002;


&#x306A;&#x304A;&#x4ED5;&#x69D8;&#x306F;&#x3001;iCalendar &#x306E; RFC (<a  rel="nofollow" href="http://www.ietf.org/rfc/rfc2445.txt">http://www.ietf.org/rfc/rfc2445.txt</a>) &#x306E;&#x4E0B;&#x8A18;
&#x90E8;&#x5206;&#x3092;&#x53C2;&#x8003;&#x306B;&#x3057;&#x3066;&#x3044;&#x307E;&#x3059;&#x3002;

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
4.8.1.9 Priority

   Property Name: PRIORITY

   Purpose: The property defines the relative priority for a calendar
   component.

   Value Type: INTEGER

   Property Parameters: Non-standard property parameters can be
   specified on this property.

   Conformance: The property can be specified in a &quot;VEVENT&quot; or &quot;VTODO&quot;
   calendar component.

   Description: The priority is specified as an integer in the range
   zero to nine. A value of zero (US-ASCII decimal 48) specifies an
   undefined priority. A value of one (US-ASCII decimal 49) is the
   highest priority. A value of two (US-ASCII decimal 50) is the
   second highest priority. Subsequent numbers specify a decreasing
   ordinal priority. A value of nine (US-ASCII decimal 58) is the
   lowest priority.

   A CUA with a three-level priority scheme of &quot;HIGH&quot;, &quot;MEDIUM&quot; and
   &quot;LOW&quot; is mapped into this property such that a property value in
   the range of one (US-ASCII decimal 49) to four (US-ASCII decimal
   52) specifies &quot;HIGH&quot; priority. A value of five (US-ASCII decimal
   53) is the normal or &quot;MEDIUM&quot; priority. A value in the range of six
   (US- ASCII decimal 54) to nine (US-ASCII decimal 58) is &quot;LOW&quot;
   priority.

   A CUA with a priority schema of &quot;A1&quot;, &quot;A2&quot;, &quot;A3&quot;, &quot;B1&quot;, &quot;B2&quot;, ...,
   &quot;C3&quot; is mapped into this property such that a property value of one
   (US-ASCII decimal 49) specifies &quot;A1&quot;, a property value of two (US-
   ASCII decimal 50) specifies &quot;A2&quot;, a property value of three
   (US-ASCII decimal 51) specifies &quot;A3&quot;, and so forth up to a property
   value of 9 (US-ASCII decimal 58) specifies &quot;C3&quot;.

   Other integer values are reserved for future use.

   Within a &quot;VEVENT&quot; calendar component, this property specifies a
   priority for the event. This property may be useful when more than
   one event is scheduled for a given time period.

   Within a &quot;VTODO&quot; calendar component, this property specified a
   priority for the to-do. This property is useful in prioritizing
   multiple action items for a given time period.

   Format Definition: The property is specified by the following
   notation:

     priority   = &quot;PRIORITY&quot; prioparam &quot;:&quot; privalue CRLF
     ;Default is zero

     prioparam  = *(&quot;;&quot; xparam)

     privalue   = integer       ;Must be in the range [0..9]
        ; All other values are reserved for future use

   The following is an example of a property with the highest
   priority:

     PRIORITY:1

   The following is an example of a property with a next highest
   priority:

     PRIORITY:2

   Example: The following is an example of a property with no
   priority.
   This is equivalent to not specifying the &quot;PRIORITY&quot; property:

     PRIORITY:0
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

</pre><pre>diff -c /tmp/mhc/emacs/mhc-minibuf.el mhc/mhc-minibuf.el
*** /tmp/mhc/emacs/mhc-minibuf.el	Wed Sep  8 18:12:10 2004
--- mhc/mhc-minibuf.el	Sun Apr 10 22:56:43 2005
***************
*** 333,338 ****
--- 333,389 ----
  	(beep)))))
  
  
+ (defvar mhc-priority-hist nil)
+ (defun mhc-input-priority (&amp;optional prompt default)
+   (interactive)
+   (let (pri)
+     (catch 'ok
+       (while t
+ 	(setq pri (read-from-minibuffer 
+ 		   (concat (or prompt &quot;Priority: &quot;) 
+ ;			   &quot;(from 0 to 100, or none) &quot;)
+ 			   (cond
+ 			    ((eq mhc-summary-display-priority-schema 'three-level)
+ 			     &quot;([Hh]igh, [Mm]iddle, [Ll]ow) &quot;)
+ 			    ((eq mhc-summary-display-priority-schema 'nine-level)
+ 			     &quot;(a1-3, b1-3, c1-3) &quot;)
+ 			    (t
+ 			     &quot;(from 0 to 100, or none) &quot;)))
+ 		   (or default &quot;&quot;)
+ 		   nil nil mhc-priority-hist 0))
+ 	(message pri)
+ 	(cond 
+ 	 ((string-match &quot;^[0-9]+&quot; pri)
+ 	  (throw 'ok (string-to-number pri)))
+ 	 ((string= &quot;&quot; pri)
+ 	  (throw 'ok nil))
+ 	 ((string-match &quot;^[Hh]&quot; pri)
+ 	  (throw 'ok 80))
+ 	 ((string-match &quot;^[Mm]&quot; pri)
+ 	  (throw 'ok 50))
+ 	 ((string-match &quot;^[Ll]&quot; pri)
+ 	  (throw 'ok 1))
+ 	 ((string-match &quot;^[Aa]1&quot; pri)
+ 	  (throw 'ok 90))
+ 	 ((string-match &quot;^[Aa]2&quot; pri)
+ 	  (throw 'ok 80))
+ 	 ((string-match &quot;^[Aa]3&quot; pri)
+ 	  (throw 'ok 70))
+ 	 ((string-match &quot;^[Bb]1&quot; pri)
+ 	  (throw 'ok 60))
+ 	 ((string-match &quot;^[Bb]2&quot; pri)
+ 	  (throw 'ok 50))
+ 	 ((string-match &quot;^[Bb]3&quot; pri)
+ 	  (throw 'ok 40))
+ 	 ((string-match &quot;^[Cc]1&quot; pri)
+ 	  (throw 'ok 30))
+ 	 ((string-match &quot;^[Cc]2&quot; pri)
+ 	  (throw 'ok 20))
+ 	 ((string-match &quot;^[Cc]3&quot; pri)
+ 	  (throw 'ok 1))
+ 	 (t
+ 	  (beep)))))))
+ 
  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  ;; input x-sc- schedule data from minibuffer.
diff -c /tmp/mhc/emacs/mhc-summary.el mhc/mhc-summary.el
*** /tmp/mhc/emacs/mhc-summary.el	Thu Oct  7 19:06:35 2004
--- mhc/mhc-summary.el	Sun Apr 10 23:07:11 2005
***************
*** 277,282 ****
--- 277,289 ----
      (gnus-group-mode   . mhc-gnus)
      (gnus-summary-mode . mhc-gnus)))
  
+ (defcustom mhc-summary-display-priority-schema 'value
+   &quot;*Valueable to set your favorite displaying priority SCHEMA.&quot;
+   :group 'mhc
+   :type '(radio (const :tag &quot;Value&quot; value)
+ 		(const :tag &quot;Three-level&quot; three-level)
+ 		(const :tag &quot;Nine-level&quot; nine-level)))
+ 
  ;; Internal Variables which are bound while inserting line:
  (defvar mhc-tmp-day-face nil &quot;a face for the day.&quot;)
  (defvar mhc-tmp-dayinfo  nil &quot;a dayinfo for the day.&quot;)
***************
*** 327,333 ****
  	(if (and (mhc-use-icon-p) (mhc-icon-exists-p &quot;conflict&quot;))
  	    (list &quot;conflict&quot;) 'mhc-summary-face-conflict))
      (?p (if mhc-tmp-priority
! 	    (format &quot;[%d]&quot; mhc-tmp-priority))
  	'face (cond 
  	       ((null mhc-tmp-priority) nil)
  	       ((&gt;= mhc-tmp-priority 80) 'mhc-summary-face-sunday)
--- 334,358 ----
  	(if (and (mhc-use-icon-p) (mhc-icon-exists-p &quot;conflict&quot;))
  	    (list &quot;conflict&quot;) 'mhc-summary-face-conflict))
      (?p (if mhc-tmp-priority
! 	    (cond
! 	     ((eq mhc-summary-display-priority-schema 'three-level)
! 	      (cond
! 	       ((&gt;= mhc-tmp-priority 80) (format &quot;[HIGH] &quot;))
! 	       ((&gt;= mhc-tmp-priority 50) (format &quot;[MIDDLE] &quot;))
! 	       (t                        (format &quot;[LOW] &quot;))))
! 	     ((eq mhc-summary-display-priority-schema 'nine-level)
! 	      (cond 
! 	       ((&gt;= mhc-tmp-priority 90) (format &quot;[A1] &quot;))
! 	       ((&gt;= mhc-tmp-priority 80) (format &quot;[A2] &quot;))
! 	       ((&gt;= mhc-tmp-priority 70) (format &quot;[A3] &quot;))
! 	       ((&gt;= mhc-tmp-priority 60) (format &quot;[B1] &quot;))
! 	       ((&gt;= mhc-tmp-priority 50) (format &quot;[B2] &quot;))
! 	       ((&gt;= mhc-tmp-priority 40) (format &quot;[B3] &quot;))
! 	       ((&gt;= mhc-tmp-priority 30) (format &quot;[C1] &quot;))
! 	       ((&gt;= mhc-tmp-priority 20) (format &quot;[C2] &quot;))
! 	       (t                        (format &quot;[C3] &quot;))))
! 	     (t
! 	      (format &quot;[%d] &quot; mhc-tmp-priority))))
  	'face (cond 
  	       ((null mhc-tmp-priority) nil)
  	       ((&gt;= mhc-tmp-priority 80) 'mhc-summary-face-sunday)
***************
*** 397,404 ****
      (?l (mhc-summary/line-location-string)
  	'face 'mhc-summary-face-location)
      (?p (if mhc-tmp-priority
! 	    (format &quot;%5s&quot; (format &quot;[%d]&quot; mhc-tmp-priority))
! 	  &quot;     &quot;)
  	'face (cond 
  	       ((null mhc-tmp-priority) nil)
  	       ((&gt;= mhc-tmp-priority 80) 'mhc-summary-face-sunday)
--- 422,447 ----
      (?l (mhc-summary/line-location-string)
  	'face 'mhc-summary-face-location)
      (?p (if mhc-tmp-priority
! 	    (cond
! 	     ((eq mhc-summary-display-priority-schema 'three-level)
! 	      (cond
! 	       ((&gt;= mhc-tmp-priority 80) (format &quot;%9s&quot; &quot;[HIGH] &quot;))
! 	       ((&gt;= mhc-tmp-priority 50) (format &quot;%9s&quot; &quot;[MIDDLE] &quot;))
! 	       (t                        (format &quot;%9s&quot; &quot;[LOW] &quot;))))
! 	     ((eq mhc-summary-display-priority-schema 'nine-level)
! 	      (cond 
! 	       ((&gt;= mhc-tmp-priority 90) (format &quot;%9s&quot; &quot;[A1] &quot;))
! 	       ((&gt;= mhc-tmp-priority 80) (format &quot;%9s&quot; &quot;[A2] &quot;))
! 	       ((&gt;= mhc-tmp-priority 70) (format &quot;%9s&quot; &quot;[A3] &quot;))
! 	       ((&gt;= mhc-tmp-priority 60) (format &quot;%9s&quot; &quot;[B1] &quot;))
! 	       ((&gt;= mhc-tmp-priority 50) (format &quot;%9s&quot; &quot;[B2] &quot;))
! 	       ((&gt;= mhc-tmp-priority 40) (format &quot;%9s&quot; &quot;[B3] &quot;))
! 	       ((&gt;= mhc-tmp-priority 30) (format &quot;%9s&quot; &quot;[C1] &quot;))
! 	       ((&gt;= mhc-tmp-priority 20) (format &quot;%9s&quot; &quot;[C2] &quot;))
! 	       (t                        (format &quot;%9s&quot; &quot;[C3] &quot;))))
! 	     (t
! 	      (format &quot;%9s&quot; (format &quot;[%d]&quot; mhc-tmp-priority))))
! 	  &quot;        &quot;)
  	'face (cond 
  	       ((null mhc-tmp-priority) nil)
  	       ((&gt;= mhc-tmp-priority 80) 'mhc-summary-face-sunday)
diff -c /tmp/mhc/emacs/mhc-vars.el mhc/mhc-vars.el
*** /tmp/mhc/emacs/mhc-vars.el	Mon Oct 13 15:46:23 2003
--- mhc/mhc-vars.el	Sun Apr 10 12:46:59 2005
***************
*** 132,137 ****
--- 132,142 ----
    :group 'mhc
    :type 'boolean)
  
+ (defcustom mhc-ask-priority nil
+   &quot;*If non-nil value, ask the priority value in making draft.&quot;
+   :group 'mhc
+   :type 'boolean)
+ 
  (provide 'mhc-vars)
  
  ;;; Copyright Notice:
diff -c /tmp/mhc/emacs/mhc.el mhc/mhc.el
*** /tmp/mhc/emacs/mhc.el	Fri Jan 14 21:07:54 2005
--- mhc/mhc.el	Sun Apr 10 22:38:09 2005
***************
*** 551,557 ****
  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  ;; import, edit, delete, modify
  
! (defcustom mhc-input-sequences '(date time subject location category alarm)
    &quot;*Sequence of the inputs.&quot;
    :group 'mhc
    :type '(repeat (choice (const :tag &quot;Date&quot; date)
--- 551,558 ----
  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  ;; import, edit, delete, modify
  
! (defcustom mhc-input-sequences 
!   '(date time subject location category alarm priority)
    &quot;*Sequence of the inputs.&quot;
    :group 'mhc
    :type '(repeat (choice (const :tag &quot;Date&quot; date)
***************
*** 559,565 ****
  			 (const :tag &quot;Subject&quot; subject)
  			 (const :tag &quot;Location&quot; location)
  			 (const :tag &quot;Category&quot; category)
! 			 (const :tag &quot;Alarm&quot; alarm))))
  
  (defun mhc-edit (&amp;optional import-buffer)
    &quot;Edit a new schedule.
--- 560,572 ----
  			 (const :tag &quot;Subject&quot; subject)
  			 (const :tag &quot;Location&quot; location)
  			 (const :tag &quot;Category&quot; category)
! 			 (const :tag &quot;Alarm&quot; alarm)
! 			 (const :tag &quot;Priority&quot; priority))))
! 
! (defcustom mhc-do-register-xsc-next nil
!   &quot;&quot;
!   :group 'mhc
!   :type 'boolean)
  
  (defun mhc-edit (&amp;optional import-buffer)
    &quot;Edit a new schedule.
***************
*** 572,578 ****
    (let ((draft-buffer (generate-new-buffer mhc-draft-buffer-name))
  	(current-date (or (mhc-current-date) (mhc-calendar-get-date)))
  	(succeed t)
! 	msgp date time subject location category priority alarm)
      (and (interactive-p)
  	 (mhc-window-push))
      (set-buffer draft-buffer)
--- 579,586 ----
    (let ((draft-buffer (generate-new-buffer mhc-draft-buffer-name))
  	(current-date (or (mhc-current-date) (mhc-calendar-get-date)))
  	(succeed t)
! 	msgp date time subject location category priority alarm
! 	(next-entry-list ()))
      (and (interactive-p)
  	 (mhc-window-push))
      (set-buffer draft-buffer)
***************
*** 651,659 ****
  			    (setq alarm
  				  (mhc-input-alarm
  				   &quot;Alarm: &quot;
! 				   mhc-default-alarm))))))
  		    ;;
! 		    (setq priority (mhc-schedule-priority schedule)))
  		;; Answer was no.
  		(message &quot;&quot;) ; flush minibuffer.
  		(and (interactive-p)
--- 659,694 ----
  			    (setq alarm
  				  (mhc-input-alarm
  				   &quot;Alarm: &quot;
! 				   mhc-default-alarm))))
! 		       ;; input priority
! 		       ((eq input 'priority)
! 			(if mhc-ask-priority
! 			    (setq priority 
! 				  (mhc-input-priority
! 				   &quot;Priority: &quot;
! 				   nil))))))
! 		    (if mhc-do-register-xsc-next
! 			(while (y-or-n-p 
! 				&quot;More Schedule (date,time,location)? &quot;)
! 			  (let (date-tmp time-tmp loc-tmp)
! 			    (setq date-tmp
! 				  (mhc-input-day &quot;Date: &quot;
! 						 current-date
! 						 (mhc-guess-date)))
! 			    (setq time-tmp
! 				  (mhc-input-time &quot;Time: &quot;
! 						  (mhc-schedule-time-as-string
! 						   schedule)
! 						  (mhc-guess-time
! 						   (mhc-minibuf-candidate-nth-begin))))
! 			    (setq loc-tmp
! 				 (mhc-input-location &quot;Location: &quot;
! 				  (mhc-schedule-location schedule)))
! 			    (setq next-entry-list 
! 				  (cons (list date-tmp time-tmp loc-tmp) next-entry-list)))))
  		    ;;
! ;		    (setq priority (mhc-schedule-priority schedule))
! 		    )
  		;; Answer was no.
  		(message &quot;&quot;) ; flush minibuffer.
  		(and (interactive-p)
***************
*** 678,684 ****
  		(setq category (mhc-input-category &quot;Category: &quot;)))
  	       ((eq input 'alarm)
  		(if mhc-ask-alarm
! 		    (setq alarm (mhc-input-alarm &quot;Alarm: &quot; mhc-default-alarm))))))))
        ;; Quit.
        (quit
         (and (interactive-p)
--- 713,731 ----
  		(setq category (mhc-input-category &quot;Category: &quot;)))
  	       ((eq input 'alarm)
  		(if mhc-ask-alarm
! 		    (setq alarm (mhc-input-alarm &quot;Alarm: &quot; mhc-default-alarm))))
! 	       ((eq input 'priority)
! 		(if mhc-ask-priority
! 		    (setq priority (mhc-input-priority &quot;Priority: &quot;))))))
! 	    (if mhc-do-register-xsc-next
! 		(while (y-or-n-p &quot;More Schedule (date,time,location)? &quot;)
! 		  (let (date-tmp time-tmp loc-tmp)
! 		    (progn 
! 		      (setq date-tmp (mhc-input-day &quot;Date: &quot; current-date))
! 		      (setq time-tmp (mhc-input-time &quot;Time: &quot;))
! 		      (setq loc-tmp (mhc-input-location &quot;Location: &quot;))
! 		      (setq next-entry-list (cons (list date-tmp time-tmp loc-tmp) next-entry-list))))))
! 	    ))
        ;; Quit.
        (quit
         (and (interactive-p)
***************
*** 723,732 ****
  			 (if begin (mhc-time-to-string begin) &quot;&quot;)
  			 (if end (concat &quot;-&quot; (mhc-time-to-string end)) &quot;&quot;)))
  		    &quot;&quot;)
  		  &quot;\nX-SC-Category: &quot;
  		  (mapconcat (function capitalize) category &quot; &quot;)
  		  &quot;\nX-SC-Priority: &quot; (if priority
! 					  (number-to-string priority)
  					&quot;&quot;)
  		  &quot;\nX-SC-Cond: &quot;
  		  &quot;\nX-SC-Duration: &quot;
--- 770,808 ----
  			 (if begin (mhc-time-to-string begin) &quot;&quot;)
  			 (if end (concat &quot;-&quot; (mhc-time-to-string end)) &quot;&quot;)))
  		    &quot;&quot;)
+ 		  )
+ 	  (if next-entry-list
+ 	      (let (date time location)
+ 		(while next-entry-list
+ 		  (setq date (car (car next-entry-list)))
+ 		  (setq time (car (cdr (car next-entry-list))))
+ 		  (setq location (car (cdr (cdr (car next-entry-list)))))
+ 		  (insert 
+ 		   &quot;\nX-SC-Next: &quot;
+ 		   &quot;\nX-SC-Location: &quot; location
+ 		   &quot;\nX-SC-Day: &quot;
+ 		   (mapconcat
+ 		    (lambda (day)
+ 		      (mhc-date-format day &quot;%04d%02d%02d&quot; yy mm dd))
+ 		    date &quot; &quot;)
+ 		   &quot;\nX-SC-Time: &quot;
+ 		   (if time
+ 		       (let ((begin (car time))
+ 			     (end (nth 1 time)))
+ 			 (concat
+ 			  (if begin (mhc-time-to-string begin) &quot;&quot;)
+ 			  (if end (concat &quot;-&quot; (mhc-time-to-string end)) &quot;&quot;)))
+ 		     &quot;&quot;)
+ 		   )
+ 		  (setq next-entry-list (cdr next-entry-list)))
+ 	      ))
+ 	  (insert
  		  &quot;\nX-SC-Category: &quot;
  		  (mapconcat (function capitalize) category &quot; &quot;)
  		  &quot;\nX-SC-Priority: &quot; (if priority
! 					  (if (stringp priority)
! 					      priority
! 					    (number-to-string priority))
  					&quot;&quot;)
  		  &quot;\nX-SC-Cond: &quot;
  		  &quot;\nX-SC-Duration: &quot;

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="02091" href="msg02091.html">[mhc:02092] patch for X-SC-Priority</a></strong>
<ul><li><em>From:</em> NOGUCHI Yusuke</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg02091.html">[mhc:02092] patch for X-SC-Priority</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg02093.html">[mhc:02094] Re: Location: guess &#x6642;&#x306E;&#x5168;&#x89D2;&#x534A;&#x89D2;&#x5909;&#x63DB;</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg02091.html">[mhc:02092] patch for X-SC-Priority</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg02098.html">[mhc:02099] guess date</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#02092"><strong>Date</strong></a></li>
<li><a href="threads.html#02092"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
