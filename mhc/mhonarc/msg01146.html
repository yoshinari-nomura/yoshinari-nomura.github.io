<!-- MHonArc v2.6.16 -->
<!--X-Subject: [mhc:01147] emacs/mhc&#45;mime.el and... -->
<!--X-From-R13: Yrvvpuv Ehmhxv <xrvvpuvNananc.bet> -->
<!--X-Date: 11 Dec 2000 18:00:35 +0900 -->
<!--X-Message-Id: uy9xnz618.fsf@kei.nanap.org -->
<!--X-Content-Type: multipart/mixed -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>[mhc:01147] emacs/mhc-mime.el and...</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg01145.html">Date Prev</a>][<a href="msg01147.html">Date Next</a>][<a href="msg01145.html">Thread Prev</a>][<a href="msg01147.html">Thread Next</a>][<a href="maillist.html#01146">Date Index</a>][<a href="threads.html#01146">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[mhc:01147] emacs/mhc-mime.el and...</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:mhc@DOMAIN.HIDDEN">mhc@xxxxxxxxxxxxx</a></li>
<li><em>Subject</em>: [mhc:01147] emacs/mhc-mime.el and...</li>
<li><em>From</em>: Keiichi Suzuki &lt;<a href="mailto:keiichi@DOMAIN.HIDDEN">keiichi@xxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: 11 Dec 2000 18:00:35 +0900</li>
<li><em>Organization</em>: Nanap</li>
<li><em>Reply-to</em>: <a href="mailto:mhc@DOMAIN.HIDDEN">mhc@xxxxxxxxxxxxx</a></li>
<li><em>Sender</em>: <a href="mailto:keiichi@DOMAIN.HIDDEN">keiichi@xxxxxxxxxxxx</a></li>
<li><em>User-agent</em>: Nana-gnus/7.1.0.24 EMY/1.13.9 (Art is long, life is short) FLIM/1.14.0 (Ninokuchi) APEL/10.2 Emacs/20.7 (i386-*-nt5.0.2195) MULE/4.1 (AOI) Meadow/1.13-Beta1++ (TANAHASHI:61)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>&#x9234;&#x6728;&#x572D;&#x4E00;&#x3068;&#x7533;&#x3057;&#x307E;&#x3059;&#x3002;

;; &#x67D0;&#x6240;&#x3067;&#x61F8;&#x6848;&#x4E8B;&#x9805;&#x3068;&#x306A;&#x3063;&#x3066;&#x3044;&#x307E;&#x3057;&#x305F;&#x306E;&#x3067;&#x3001;&#x3057;&#x3070;&#x3089;&#x304F;&#x524D;&#x304B;&#x3089;&#x4F7F;&#x308F;&#x305B;&#x3066;&#x3044;
;; &#x305F;&#x3060;&#x3044;&#x3066;&#x3044;&#x307E;&#x3059;&#x3002;

&#x65E9;&#x901F;&#x306A;&#x306E;&#x3067;&#x3059;&#x304C;&#x3001;&#x304A;&#x9858;&#x3044;&#x3092;&#x3044;&#x304F;&#x3064;&#x304B;...

1. mhc-mime.el &#x306E; mhc-mime-import-buffer() &#x306A;&#x306E;&#x3067;&#x3059;&#x304C;&#x3001;
   mime-message-structure &#x3092;&#x5143;&#x306B;&#x3001; import &#x3059;&#x308B;&#x3088;&#x3046;&#x306A;&#x5B9F;&#x88C5;&#x306B;&#x5909;&#x3048;&#x3066;
   &#x3044;&#x305F;&#x3060;&#x3051;&#x306A;&#x3044;&#x3067;&#x3057;&#x3087;&#x3046;&#x304B;?

   &#x3053;&#x308C;&#x306B;&#x95A2;&#x3057;&#x3066;&#x306F;&#x3001;&#x4E00;&#x5FDC; patch &#x3092;&#x4ED8;&#x3051;&#x3066;&#x304A;&#x304D;&#x307E;&#x3059;&#x3002;(CVS &#x306E;&#x5E79;&#x306E;&#x5148;&#x7AEF;
   &#x304B;&#x3089;&#x306E;&#x5DEE;&#x5206;&#x3067;&#x3059;&#x3002;)

   &#x305F;&#x3060;&#x3001; gnus &#x4EE5;&#x5916;&#x306E;&#x3082;&#x306E;&#x306B;&#x95A2;&#x3057;&#x3066;&#x306F;&#x826F;&#x304F;&#x308F;&#x304B;&#x3089;&#x306A;&#x3044;&#x306E;&#x3067;&#x3001;&#x3059;&#x307F;&#x307E;&#x305B;
   &#x3093;&#x304C;&#x3001;&#x624B;&#x3092;&#x3064;&#x3051;&#x3066;&#x3044;&#x307E;&#x305B;&#x3093;&#x3002;(&#x3053;&#x308C;&#x3067;&#x3001; Nana7 &#x3067;&#x3082;&#x4F55;&#x3082;&#x3057;&#x306A;&#x304F;&#x3066;&#x3082;
   &#x52D5;&#x304F;&#x3088;&#x3046;&#x306B;&#x306A;&#x308B;&#x3068;&#x601D;&#x3044;&#x307E;&#x3059;&#x3002;)

2. C-c . | &#x3067; import &#x5143;&#x306E;&#x30E1;&#x30C3;&#x30BB;&#x30FC;&#x30B8;&#x304B;&#x3089;&#x65E5;&#x4ED8;&#x3092;&#x63A8;&#x5B9A;&#x3059;&#x308B;&#x6642;&#x306B;
   `yyyy-mm-dd' &#x3068;&#x3044;&#x3046;&#x5F62;&#x5F0F;&#x306E;&#x3082;&#x306E;&#x3082;&#x65E5;&#x4ED8;&#x3068;&#x3057;&#x3066;&#x8A8D;&#x8B58;&#x3059;&#x308B;&#x3088;&#x3046;&#x306B;&#x3057;&#x3066;&#x3044;
   &#x305F;&#x3060;&#x3051;&#x306A;&#x3044;&#x3067;&#x3057;&#x3087;&#x3046;&#x304B;?

   ;; &#x3061;&#x3083;&#x3093;&#x3068;&#x8ABF;&#x3079;&#x305F;&#x308F;&#x3051;&#x3067;&#x306F;&#x306A;&#x3044;&#x306E;&#x3067;&#x3059;&#x304C; man cvs &#x306B;&#x3088;&#x308B;&#x3068; ISO &#x5F62;
   ;; &#x5F0F;&#x3060;&#x305D;&#x3046;&#x3067;&#x3059;&#x3002;

&#x3088;&#x308D;&#x3057;&#x304F;&#x304A;&#x9858;&#x3044;&#x3057;&#x307E;&#x3059;&#x3002;

-- 
&#x9234;&#x6728;&#x572D;&#x4E00; / keiichi@xxxxxxxxx
PGP finger print (DH/DSS)
0B32 B37E 6DE9 3BC1 68A4  4089 7AAF 2B03 ECBD 614B

</pre><pre>Index: mhc-gnus.el
===================================================================
RCS file: /cvsroot/mhc/emacs/mhc-gnus.el,v
retrieving revision 1.12
diff -u -r1.12 mhc-gnus.el
--- mhc-gnus.el	2000/07/28 00:28:06	1.12
+++ mhc-gnus.el	2000/12/11 08:39:20
@@ -15,7 +15,9 @@
 
 ;;; Code:
 
-(eval-when-compile (require 'cl))
+(eval-when-compile
+  (require 'cl)
+  (require 'gnus-art))
 (require 'gnus-sum)
 (require 'nnmhc)
 
@@ -74,6 +76,11 @@
   gnus-original-article-buffer)
 
 
+(defun mhc-gnus-mime-get-mime-structure ()
+  (gnus-summary-select-article)
+  gnus-current-headers)
+
+
 (defsubst mhc-gnus/date-to-group-name (date)
   (mhc-date-format date &quot;%s/%02d/%02d&quot; mhc-base-folder yy mm))
 
@@ -185,6 +192,7 @@
   (put 'mhc-gnus 'draft-reedit-file 'mhc-mime-draft-reedit-file)
   (put 'mhc-gnus 'get-import-buffer 'mhc-mime-get-import-buffer)
   (put 'mhc-gnus 'mime-get-raw-buffer 'mhc-gnus-mime-get-raw-buffer)
+  (put 'mhc-gnus 'mime-get-mime-structure 'mhc-gnus-mime-get-mime-structure)
   (put 'mhc-gnus 'draft-translate 'mhc-mime-draft-translate)
   (put 'mhc-gnus 'eword-decode-string 'mhc-mime-eword-decode-string))
 
Index: mhc-mime.el
===================================================================
RCS file: /cvsroot/mhc/emacs/mhc-mime.el,v
retrieving revision 1.5
diff -u -r1.5 mhc-mime.el
--- mhc-mime.el	2000/08/04 02:19:02	1.5
+++ mhc-mime.el	2000/12/11 08:39:20
@@ -20,16 +20,27 @@
   (funcall (mhc-get-function 'mime-get-raw-buffer)))
 
 
+(defsubst mhc-mime-get-mime-structure ()
+  &quot;Get raw buffer of the current message for `mhc-mime-get-import-buffer'.&quot;
+  (let ((function (mhc-get-function 'mime-get-mime-structure)))
+    (when function
+      (funcall function))))
+
+
 (defvar mhc-mime-import-buffer &quot; *MHC MIME import*&quot;)
 (defun mhc-mime-get-import-buffer (get-original)
-  (let ((raw-buffer (mhc-mime-get-raw-buffer))
-	mime-view-ignored-field-list)
+  (let* ((structure (mhc-mime-get-mime-structure))
+	 (raw-buffer (when (or get-original (not structure))
+		       (mhc-mime-get-raw-buffer)))
+	 mime-view-ignored-field-list)
     (with-current-buffer (get-buffer-create mhc-mime-import-buffer)
-      (mime-view-buffer raw-buffer (current-buffer))
+      (if structure
+	  (mime-display-message structure (current-buffer))
+	(mime-view-buffer raw-buffer (current-buffer)))
       (let (buffer-read-only)
 	(mhc-highlight-message))
       (if get-original
-	  (cons raw-buffer (current-buffer))
+	  (cons (mhc-mime-get-raw-buffer) (current-buffer))
 	(current-buffer)))))
 
 
</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="01147" href="msg01147.html">[mhc:01148] Re: emacs/mhc-mime.el and...</a></strong>
<ul><li><em>From:</em> Yuuichi Teranishi</li></ul></li>
<li><strong><a name="01149" href="msg01149.html">[mhc:01150] Re: emacs/mhc-mime.el and...</a></strong>
<ul><li><em>From:</em> Yoshinari Nomura</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg01145.html">[mhc:01146] XHisho Ver.1.70</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg01147.html">[mhc:01148] Re: emacs/mhc-mime.el and...</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg01145.html">[mhc:01146] XHisho Ver.1.70</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg01147.html">[mhc:01148] Re: emacs/mhc-mime.el and...</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#01146"><strong>Date</strong></a></li>
<li><a href="threads.html#01146"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
