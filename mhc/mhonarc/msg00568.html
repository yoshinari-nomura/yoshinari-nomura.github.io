<!-- MHonArc v2.6.16 -->
<!--X-Subject: [mhc:00569] Re: mhc&#45;snap20000427.tar.gz -->
<!--X-From-R13: Kbfuvanev @A[GDO <abzNpfpr.xlhfuh&#45;h.np.wc> -->
<!--X-Date: Fri, 28 Apr 2000 16:18:58 +0900 -->
<!--X-Message-Id: 20000428161856R.nom@csce.kyushu&#45;u.ac.jp -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20000428132529D.nom@csce.kyushu&#45;u.ac.jp -->
<!--X-Reference: 20000428.131917.110255748.taro@fc.jpn.org -->
<!--X-Reference: 20000428.135457.114698342.shirai@rdmg.mgcs.mei.co.jp -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>[mhc:00569] Re: mhc-snap20000427.tar.gz</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00567.html">Date Prev</a>][<a href="msg00569.html">Date Next</a>][<a href="msg00566.html">Thread Prev</a>][<a href="msg00569.html">Thread Next</a>][<a href="maillist.html#00568">Date Index</a>][<a href="threads.html#00568">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[mhc:00569] Re: mhc-snap20000427.tar.gz</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:mhc@DOMAIN.HIDDEN">mhc@xxxxxxxxxxxxxxxxxxxxxxxxx</a></li>
<li><em>Subject</em>: [mhc:00569] Re: mhc-snap20000427.tar.gz</li>
<li><em>From</em>: Yoshinari NOMURA &lt;<a href="mailto:nom@DOMAIN.HIDDEN">nom@xxxxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Fri, 28 Apr 2000 16:18:58 +0900</li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:20000428.135457.114698342.shirai@DOMAIN.HIDDEN">20000428.135457.114698342.shirai@xxxxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Posted</em>: Fri, 28 Apr 2000 16:18:56 +0900</li>
<li><em>References</em>: &lt;<a href="mailto:20000428132529D.nom@DOMAIN.HIDDEN">20000428132529D.nom@xxxxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:20000428.131917.110255748.taro@DOMAIN.HIDDEN">20000428.131917.110255748.taro@xxxxxxxxxx</a>&gt;	&lt;<a href="mailto:20000428.135457.114698342.shirai@DOMAIN.HIDDEN">20000428.135457.114698342.shirai@xxxxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Reply-to</em>: <a href="mailto:mhc@DOMAIN.HIDDEN">mhc@xxxxxxxxxxxxxxxxxxxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>&#x4E43;&#x6751;&#x3067;&#x3059;&#x3002;

On Fri, 28 Apr 2000 13:56:11 +0900,
	Hideyuki SHIRAI (&#x767D;&#x4E95;&#x79C0;&#x884C;) &lt;shirai@xxxxxxxxxxxxxxxxxxx&gt; said:

&gt; &#x3082;&#x3057;&#x304B;&#x3057;&#x3066;&#x3001;(&#x78BA;&#x304B;)Windows &#x3063;&#x3066; open &#x3057;&#x3066;&#x3044;&#x308B;&#x3068; mv &#x51FA;&#x6765;&#x306A;&#x3044;&#x3063;&#x3066;
&gt; &#x5974;&#x304B;&#x3082;&#x3057;&#x308C;&#x306A;&#x3044;&#x3002;
&gt; 
&gt; # &#x305F;&#x3081;&#x305D;&#x3046;&#x3068;&#x601D;&#x3063;&#x305F;&#x3093;&#x3067;&#x3059;&#x304C;&#x3001;close &#x306E;&#x66F8;&#x304D;&#x65B9;&#x304C;&#x308F;&#x304B;&#x3089;&#x306A;&#x3044;&#x5974; ^^;

&#x306A;&#x308B;&#x307B;&#x3069;&#x3002;&#x305D;&#x308C;&#x306A;&#x3089;&#x5FC3;&#x5F53;&#x308A;&#x3042;&#x308A;&#x307E;&#x3059;&#x3002;ruby &#x3063;&#x3066; FD &#x304C;&#x8DB3;&#x308A;&#x306A;&#x304F;&#x306A;&#x3063;&#x305F;
&#x3089; unref &#x306B;&#x306A;&#x3063;&#x305F;&#x3084;&#x3064;&#x3092;&#x81EA;&#x52D5;&#x7684;&#x306B; close &#x3057;&#x3066;&#x304F;&#x308C;&#x308B;&#x3068;&#x805E;&#x3044;&#x3066;&#x3044;&#x305F;&#x306E;&#x3067;&#x3001;
&#x305D;&#x306E;&#x307E;&#x307E;&#x653E;&#x3063;&#x3066;&#x308B;&#x7B87;&#x6240;&#x304C;&#x4F55;&#x7B87;&#x6240;&#x304B;&#x3042;&#x308A;&#x305D;&#x3046;&#x3067;&#x3059;&#x3002;

# &#x3061;&#x306A;&#x307F;&#x306B; file &#x306E; close &#x306F; file .close &#x3067;&#x9589;&#x3058;&#x3089;&#x308C;&#x307E;&#x3059;&#x3002;

&gt; &#x79C1;&#x3001;UNIX &#x3082; Win &#x3082; tcsh &#x306A;&#x3093;&#x3067;&#x3059; :-) jis &#x306E;&#x307E;&#x307E;&#x3067;&#x3082;&#x3044;&#x3044;&#x304B;&#x3089;
&gt; stdout &#x304C;&#x3044;&#x3044;&#x306A;&#x3002;

&#x5931;&#x793C;&#x3002;|&amp; &#x3067;&#x3059;&#x3057;&#x305F;&#x304B;&#x3002;(&#x3082;&#x3046;&#x3044;&#x3044;&#x3063;&#x3066;?) to_sjis &#x3059;&#x308B;&#x3088;&#x3046;&#x306B;&#x3057;&#x307E;&#x3059;&#x3002;
close &#x3068;&#x6F22;&#x5B57;&#x30B3;&#x30FC;&#x30C9;&#x306E;&#x4FEE;&#x6B63;&#x30D1;&#x30C3;&#x30C1;&#x3092;&#x5F8C;&#x308D;&#x306B;&#x4ED8;&#x3051;&#x307E;&#x3059;&#x3002;

&gt; &#x5B8C;&#x5168; local &#x306A; network (&#x4F8B;&#x3048;&#x3070;&#x793E;&#x5185; only) &#x3067;&#x4F7F;&#x3046;&#x4EBA;&#x3082;&#x3044;&#x308B;&#x3067;&#x3042;&#x308D;&#x3046;&#x3053;
&gt; &#x3068;&#x3092;&#x8003;&#x3048;&#x308B;&#x3068;&#x3001;&#x6697;&#x53F7;&#x5316;&#x3057;&#x306A;&#x3044;&#x3067; sync &#x3059;&#x308B;&#x624B;&#x6BB5;&#x304C;&#x3042;&#x3063;&#x3066;&#x3082;&#x304B;&#x307E;&#x308F;&#x306A;&#x3044;&#x3068;
&gt; &#x601D;&#x3044;&#x307E;&#x3059;&#x3002;(&#x6697;&#x53F7;&#x5316;&#x3057;&#x305F;&#x3044;&#x4EBA;&#x306F;&#x6697;&#x53F7;&#x5316;&#x3059;&#x308B;&#x3001;&#x3068;&#x3044;&#x3046;&#x3053;&#x3068;&#x3067;)

&#x3075;&#x3080;&#x3002;&#x7121;&#x6CD5;&#x5730;&#x5E2F;&#x306E;&#x5927;&#x5B66;&#x3067;&#x66AE;&#x3089;&#x3057;&#x3066;&#x3044;&#x308B;&#x306E;&#x3067;&#x3001;&#x8A8D;&#x8B58;&#x4E0D;&#x8DB3;&#x3067;&#x3057;&#x305F;&#x3002;

&#x3053;&#x308C;&#x3092;&#x3084;&#x308B;&#x3068;&#x3059;&#x308C;&#x3070;&#x3001;&#x901A;&#x4FE1;&#x306E;&#x624B;&#x6BB5;&#x306F;&#x4F55;&#x304C;&#x3044;&#x3044;&#x306E;&#x3067;&#x3057;&#x3087;&#x3046;&#x3002;telnet &#x306A;&#x3089;&#x3001;
ruby &#x306E; TCPsocket &#x30AF;&#x30E9;&#x30B9;&#x4F7F;&#x3063;&#x3066;&#x3084;&#x308C;&#x3070;&#x3001;&#x5916;&#x90E8;&#x30B3;&#x30DE;&#x30F3;&#x30C9;&#x306F;&#x4E0D;&#x8981;&#x306B;&#x306A;&#x308B;&#x304B;
&#x3082;&#x3057;&#x308C;&#x307E;&#x305B;&#x3093;&#x3002;elisp &#x3060;&#x3068; open-network-stream &#x3067;&#x4F55;&#x3068;&#x304B;&#x306A;&#x308B;&#x304B;&#x3057;&#x3089;&#x3002;

# expect &#x307F;&#x305F;&#x3044;&#x306A;&#x3053;&#x3068;&#x3084;&#x3063;&#x3066;&#x304F;&#x308C;&#x308B;&#x306E;&#x304C;&#x3042;&#x308C;&#x3070;&#x697D;&#x306A;&#x306E;&#x3067;&#x3059;&#x304C;&#x3002;&#x3002;
--
nom

Index: mhc-sync
===================================================================
RCS file: /u/nom/prj/cvsroot/mhc/mhc-sync,v
retrieving revision 1.5
retrieving revision 1.7
diff -u -r1.5 -r1.7
--- mhc-sync	2000/04/26 11:47:03	1.5
+++ mhc-sync	2000/04/28 06:27:43	1.7
@@ -3,6 +3,17 @@
 STDOUT .sync = true
 STDIN  .sync = true
 
+require 'kconv'
+
+case $KCODE
+when 'JIS'
+  $KANJI_CODE = Kconv::JIS
+when 'SJIS'
+  $KANJI_CODE = Kconv::SJIS
+else
+  $KANJI_CODE = Kconv::EUC
+end
+
 $LOG_FILE = ENV[&quot;HOME&quot;] + '/Mail/schedule/.mhc-db-log'
 $SSH         = 'ssh'
 $COMMAND     = 'mhc-sync'
@@ -34,11 +45,11 @@
 
 class MhcScheduleItem
   def info
-    return format(&quot;%s (first occurred %s)&quot;, subject, occur_min .to_s1('-'))
+    ret = format(&quot;%s (first occurred %s)&quot;, subject, occur_min .to_s1('-'))
+    return Kconv::kconv(ret, $KANJI_CODE, true)
   end
 end
 
-
 class MhcScheduleDB
 
   def modify_sch(sch)
@@ -259,9 +270,11 @@
       inout .print $DELIMITOR, &quot;\n&quot;
 
     when '-D' # delete local
-      STDERR .print &quot;---------------------------------------------------\n&quot;
-      STDERR .print &quot;Delete local #{l_sch .info}\n&quot;
-      db .del_sch(l_sch) if !$DRY_RUN
+      if l_sch
+	STDERR .print &quot;---------------------------------------------------\n&quot;
+	STDERR .print &quot;Delete local #{l_sch .info}\n&quot;
+	db .del_sch(l_sch) if !$DRY_RUN
+      end
 
     when '-M' # transfer remote to local
       STDERR .print &quot;---------------------------------------------------\n&quot;
Index: ruby-ext/lib/mhc-schedule.rb
===================================================================
RCS file: /u/nom/prj/cvsroot/mhc/ruby-ext/lib/mhc-schedule.rb,v
retrieving revision 1.17
retrieving revision 1.18
diff -u -r1.17 -r1.18
--- mhc-schedule.rb	2000/04/26 10:47:51	1.17
+++ mhc-schedule.rb	2000/04/28 06:19:40	1.18
@@ -3,7 +3,7 @@
 ## Author:  Yoshinari Nomura &lt;nom@xxxxxxx&gt;
 ##
 ## Created: 1999/07/16
-## Revised: $Date: 2000/04/26 10:47:51 $
+## Revised: $Date: 2000/04/28 06:19:40 $
 ##
 
 ################################################################
@@ -825,7 +825,9 @@
     ## 3. set @description
 
     clear
-    all_headers = File .open(path, &quot;r&quot;) .gets(&quot;\n\n&quot;)
+    file = File .open(path, &quot;r&quot;)
+    all_headers =  file .gets(&quot;\n\n&quot;)
+    file .close
     @non_xsc_header, xsc_header_hash = select_headers(all_headers)
     parse_xsc_headers(xsc_header_hash)
     @path = path
@@ -1233,6 +1235,7 @@
 	  header += line
 	end
       end
+      file .close
       if  header != ''
 	regist(slot, MhcScheduleItem .new(header, false))
       end
</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00569" href="msg00569.html">[mhc:00570] Re: mhc-snap20000427.tar.gz</a></strong>
<ul><li><em>From:</em> &#x767D;&#x4E95;&#x79C0;&#x884C;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00564" href="msg00564.html">[mhc:00565] Re: mhc-snap20000427.tar.gz</a></strong>
<ul><li><em>From:</em> Yoshinari NOMURA</li></ul></li>
<li><strong><a name="00563" href="msg00563.html">[mhc:00564] Re: mhc-snap20000427.tar.gz</a></strong>
<ul><li><em>From:</em> &#x6749;&#x68EE; &#x9686;&#x884C;</li></ul></li>
<li><strong><a name="00565" href="msg00565.html">[mhc:00566] Re: mhc-snap20000427.tar.gz</a></strong>
<ul><li><em>From:</em> &#x767D;&#x4E95;&#x79C0;&#x884C;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00567.html">[mhc:00568] pserver</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00569.html">[mhc:00570] Re: mhc-snap20000427.tar.gz</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00566.html">[mhc:00567] Re: mhc-snap20000427.tar.gz</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00569.html">[mhc:00570] Re: mhc-snap20000427.tar.gz</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00568"><strong>Date</strong></a></li>
<li><a href="threads.html#00568"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
