<!-- MHonArc v2.6.16 -->
<!--X-Subject: [mhc:02224] Re: patch for mhc2ol.in -->
<!--X-From-R13: @AUGQVW Khfhxr <abthabthNzin.ovtybor.ar.wc> -->
<!--X-Date: Thu, 19 Oct 2006 19:59:24 +0900 (JST) -->
<!--X-Message-Id: 20061019.195924.103009745.nogunogu@mva.biglobe.ne.jp -->
<!--X-Content-Type: multipart/mixed -->
<!--X-Reference: 20061002.180555.68558599.nogunogu@mva.biglobe.ne.jp -->
<!--X-Reference: 20061002.195334.68555966.nogunogu@mva.biglobe.ne.jp -->
<!--X-Reference: 20061003.113345.26214386.nogunogu@mva.biglobe.ne.jp -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>[mhc:02224] Re: patch for mhc2ol.in</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg02222.html">Date Prev</a>][<a href="msg02224.html">Date Next</a>][<a href="msg02221.html">Thread Prev</a>][<a href="msg02226.html">Thread Next</a>][<a href="maillist.html#02223">Date Index</a>][<a href="threads.html#02223">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[mhc:02224] Re: patch for mhc2ol.in</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:mhc@DOMAIN.HIDDEN">mhc@xxxxxxxxxxxxx</a></li>
<li><em>Subject</em>: [mhc:02224] Re: patch for mhc2ol.in</li>
<li><em>From</em>: NOGUCHI Yusuke &lt;<a href="mailto:nogunogu@DOMAIN.HIDDEN">nogunogu@xxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Thu, 19 Oct 2006 19:59:24 +0900 (JST)</li>
<li><em>Delivered-to</em>: <a href="mailto:mhc@DOMAIN.HIDDEN">mhc@xxxxxxxxxxxxx</a></li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:20061003.113345.26214386.nogunogu@DOMAIN.HIDDEN">20061003.113345.26214386.nogunogu@xxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>List-help</em>: &lt;<a href="mailto:mhc-ctl@quickhack.net?body=help">mailto:mhc-ctl@quickhack.net?body=help</a>&gt;</li>
<li><em>List-id</em>: mhc.quickhack.net</li>
<li><em>List-owner</em>: &lt;<a href="mailto:mhc-admin@quickhack.net">mailto:mhc-admin@quickhack.net</a>&gt;</li>
<li><em>List-post</em>: &lt;<a href="mailto:mhc@quickhack.net">mailto:mhc@quickhack.net</a>&gt;</li>
<li><em>List-software</em>: fml [fml 4.0.3 release (20011202/4.0.3)]</li>
<li><em>List-unsubscribe</em>: &lt;<a href="mailto:mhc-ctl@quickhack.net?body=unsubscribe">mailto:mhc-ctl@quickhack.net?body=unsubscribe</a>&gt;</li>
<li><em>References</em>: &lt;<a href="mailto:20061002.180555.68558599.nogunogu@DOMAIN.HIDDEN">20061002.180555.68558599.nogunogu@xxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:20061002.195334.68555966.nogunogu@DOMAIN.HIDDEN">20061002.195334.68555966.nogunogu@xxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:20061003.113345.26214386.nogunogu@DOMAIN.HIDDEN">20061003.113345.26214386.nogunogu@xxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Reply-to</em>: <a href="mailto:mhc@DOMAIN.HIDDEN">mhc@xxxxxxxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>&#x91CE;&#x53E3;&#x3067;&#x3059;&#x3002;


From: NOGUCHI Yusuke &lt;nogunogu@xxxxxxxxxxxxxxxxx&gt;
Subject: [mhc:02222] Re: patch for mhc2ol.in
Date: Tue, 03 Oct 2006 11:33:45 +0900 (JST)

&#x3067;&#x5F53; ML &#x306B;&#x5FA1;&#x63D0;&#x6848;&#x3057;&#x305F; patch &#x3067;&#x3059;&#x304C;&#x3001;

X-SC-Day: 20061024
X-SC-Time: 
X-SC-Alarm: 1 day

&#x306E;&#x69D8;&#x306B;&#x3001;X-SC-Time: &#x304C;&#x7A7A;&#x306E;&#x30B9;&#x30B1;&#x30B8;&#x30E5;&#x30FC;&#x30EB;&#x3067;&#x7570;&#x5E38;&#x7D42;&#x4E86;&#x3059;&#x308B;&#x554F;&#x984C;&#x304C;&#x3042;&#x308A;&#x307E;&#x3057;&#x305F;&#x3002;
&#x4E0A;&#x8A18;&#x306E;&#x554F;&#x984C;&#x3092;&#x4FEE;&#x6B63;&#x3057;&#x305F; patch &#x3092;&#x518D;&#x5EA6;&#x304A;&#x9001;&#x308A;&#x3055;&#x305B;&#x3066;&#x3044;&#x305F;&#x3060;&#x304D;&#x307E;&#x3059;&#x3002;

&#x4EE5;&#x4E0A;&#x3001;&#x3054;&#x691C;&#x8A0E;&#x3044;&#x305F;&#x3060;&#x3051;&#x308C;&#x3070;&#x5E78;&#x3044;&#x3067;&#x3059;
-- 
NOGUCHI Yusuke &lt;nogunogu@xxxxxxxxxxxxxxxxx&gt;


</pre><pre>*** mhc2ol.in.org	Mon May  2 07:55:08 2005
--- mhc2ol.in	Thu Oct 19 19:49:52 2006
***************
*** 65,70 ****
--- 65,86 ----
        [@stime, @etime]
      end
  
+     def get_sdatetime
+       if @stime .nil?
+ 	Time .local(@sdate. y, @sdate. m, @sdate .d, 0, 0)
+       else
+ 	Time .local(@sdate. y, @sdate. m, @sdate .d, @stime .hh, @stime .mm)
+       end
+     end
+ 
+     def get_edatetime
+       if @stime .nil?
+ 	Time .local(@edate. y, @edate. m, @edate .d, 0, 0)
+       else
+ 	Time .local(@edate. y, @edate. m, @edate .d, @etime .hh, @etime .mm)
+       end
+     end
+ 
      def handle_recurrence(ol_appoint)
      end
  
***************
*** 183,189 ****
  
  def usage
    print '
! usage: mhc2ol [-a | -i | -d | -N] [-H] [-n] [-s] [-m] [-r dir] [-c category] [YYYYMMDD-yyyymmdd]
  
    mhc2ol -- Add/Copy mhc articles to Outlook.
  
--- 199,205 ----
  
  def usage
    print '
! usage: mhc2ol [-a | -i | -d | -N] [-A] [-H] [-n] [-s] [-m] [-r dir] [-c category] [YYYYMMDD-yyyymmdd]
  
    mhc2ol -- Add/Copy mhc articles to Outlook.
  
***************
*** 205,210 ****
--- 221,227 ----
               ~/Mail/schedule
      -c     : Copy only the mhc articles of which the category
               matches the specified regexp.
+     -A     : Disable reminder if the mhc article already has been passed.
  
      YYYYMMDD-yyyymmdd : set a start and end date of scanning mhc.
                          if omitted, scan from 3 months ago to
***************
*** 341,346 ****
--- 358,364 ----
    @@flag_export_part = 'all' # 'all' || 'body_only'
    @@flag_noharm = false
    @@flag_timestamp = false
+   @@flag_disable_passed_sch = false
    @@mhc_category_name = 'MHC-sch'
    @@additional_category = false
  
***************
*** 475,482 ****
  
        # a reminder is valid for a future schedule.
        if sch .alarm() != nil then
! 	appoint .ReminderSet = true
! 	appoint .ReminderMinutesBeforeStart = sch .alarm() / 60
        else
  	appoint .ReminderSet = false
        end
--- 493,504 ----
  
        # a reminder is valid for a future schedule.
        if sch .alarm() != nil then
! 	if period .get_sdatetime &gt;= Time .now &amp;&amp; $flag_disable_passed_sch
! 	  appoint .ReminderSet = true
! 	  appoint .ReminderMinutesBeforeStart = sch .alarm() / 60
! 	else
! 	  appoint .ReminderSet = false
! 	end
        else
  	appoint .ReminderSet = false
        end
***************
*** 752,757 ****
--- 774,783 ----
      @@flag_additional_category = flag
    end
  
+   def Exporter.set_flag_disable_passed_sch(flag)
+     @@set_flag_disable_passed_sch = flag
+   end
+ 
    def Exporter.to_ol_date(date)
      format(&quot;%4d/%02d/%02d&quot;, date .y(), date .m(), date .d()) if date
    end
***************
*** 775,780 ****
--- 801,807 ----
  $flag_separation = false
  $flag_discreet = false
  $flag_additional_category = false
+ $flag_disable_passed_sch = false
  
  while ARGV .length &gt; 0
    case ARGV[0]
***************
*** 804,809 ****
--- 831,838 ----
      $flag_separation = true
    when '-m'
      $flag_additional_category = true
+   when '-A'
+     $flag_disable_passed_sch = true
    else
      usage()
    end
***************
*** 850,855 ****
--- 879,885 ----
  Exporter .set_flag_noharm($flag_noharm)
  Exporter .set_flag_timestamp($flag_timestamp)
  Exporter .set_flag_additional_category($flag_additional_category)
+ Exporter .set_flag_disable_passed_sch($flag_disable_passed_sch)
  exporter = Exporter .new(mdb, outlook)
  exporter .set_category_regexp($flag_category_regexp)
  exporter .delete_ol_schedules()
</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="02226" href="msg02226.html">[mhc:02227] Re: patch for mhc2ol.in</a></strong>
<ul><li><em>From:</em> Yoshinari Nomura</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="02219" href="msg02219.html">[mhc:02220] patch for mhc2ol.in</a></strong>
<ul><li><em>From:</em> NOGUCHI Yusuke</li></ul></li>
<li><strong><a name="02220" href="msg02220.html">[mhc:02221] Re: patch for mhc2ol.in</a></strong>
<ul><li><em>From:</em> NOGUCHI Yusuke</li></ul></li>
<li><strong><a name="02221" href="msg02221.html">[mhc:02222] Re: patch for mhc2ol.in</a></strong>
<ul><li><em>From:</em> NOGUCHI Yusuke</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg02222.html">[mhc:02223] Re: patch for mhc2ol.in</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg02224.html">[mhc:02225] mhc-sync &#x30C8;&#x30E9;&#x30D6;&#x30EB;</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg02221.html">[mhc:02222] Re: patch for mhc2ol.in</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg02226.html">[mhc:02227] Re: patch for mhc2ol.in</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#02223"><strong>Date</strong></a></li>
<li><a href="threads.html#02223"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
