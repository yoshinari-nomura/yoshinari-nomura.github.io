<!-- MHonArc v2.6.16 -->
<!--X-Subject: [mhc:01627] Re: =?ISO&#45;2022&#45;JP?B?GyRCJSslbCVzJUAkTiVVJSkhPCVeJUMlSBsoQg==?= -->
<!--X-From-R13: Vvqrlhxv EVWDOW (=?vfb&#45;2022&#45;wc?P?UlDQD3WjLw0bAHCoYSW=?=) <fuvenvNdhvpxunpx.arg> -->
<!--X-Date: Thu, 19 Sep 2002 12:39:07 +0900 (JST) -->
<!--X-Message-Id: 20020919.123907.20481649.shirai@rdmg.mgcs.mei.co.jp -->
<!--X-Content-Type: multipart/mixed -->
<!--X-Reference: 200209182319.g8INJJN07164@elflock.isuzu.co.jp -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>[mhc:01627] Re: &#x30AB;&#x30EC;&#x30F3;&#x30C0;&#x306E;&#x30D5;&#x30A9;&#x30FC;&#x30DE;&#x30C3;&#x30C8;</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg01625.html">Date Prev</a>][<a href="msg01627.html">Date Next</a>][<a href="msg01625.html">Thread Prev</a>][<a href="msg01627.html">Thread Next</a>][<a href="maillist.html#01626">Date Index</a>][<a href="threads.html#01626">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[mhc:01627] Re: &#x30AB;&#x30EC;&#x30F3;&#x30C0;&#x306E;&#x30D5;&#x30A9;&#x30FC;&#x30DE;&#x30C3;&#x30C8;</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:mhc@DOMAIN.HIDDEN">mhc@xxxxxxxxxxxxx</a></li>
<li><em>Subject</em>: [mhc:01627] Re: &#x30AB;&#x30EC;&#x30F3;&#x30C0;&#x306E;&#x30D5;&#x30A9;&#x30FC;&#x30DE;&#x30C3;&#x30C8;</li>
<li><em>From</em>: Hideyuki SHIRAI (&#x767D;&#x4E95;&#x79C0;&#x884C;) &lt;<a href="mailto:shirai@DOMAIN.HIDDEN">shirai@xxxxxxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Thu, 19 Sep 2002 12:39:07 +0900 (JST)</li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:200209182319.g8INJJN07164@DOMAIN.HIDDEN">200209182319.g8INJJN07164@xxxxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Organization</em>: QuickHackers, Tokyo, JAPAN</li>
<li><em>References</em>: &lt;<a href="mailto:200209182319.g8INJJN07164@DOMAIN.HIDDEN">200209182319.g8INJJN07164@xxxxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Reply-to</em>: <a href="mailto:mhc@DOMAIN.HIDDEN">mhc@xxxxxxxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>From: Takashi Hiromatsu &lt;takashi-hiromatsu@xxxxxxxxxxx&gt; &#x3055;&#x3093;&#x66F0;&#x304F;
Subject: [mhc:01626] &#x30AB;&#x30EC;&#x30F3;&#x30C0;&#x306E;&#x30D5;&#x30A9;&#x30FC;&#x30DE;&#x30C3;&#x30C8;
Message-ID: &lt;200209182319.g8INJJN07164@xxxxxxxxxxxxxxxxxxx&gt;
Date: Thu, 19 Sep 2002 08:17:36 +0900

&#x3053;&#x3093;&#x306B;&#x3061;&#x306F;&#x767D;&#x4E95;&#x3067;&#x3059;&#x3002;

&#x5E83;&#x677E;&gt; &#x3055;&#x3066;&#x3001;&#x672C;&#x984C;&#x3067;&#x3059;&#x304C;&#x3001;&#x30AB;&#x30EC;&#x30F3;&#x30C0;&#x306E;&#x30D5;&#x30A9;&#x30FC;&#x30DE;&#x30C3;&#x30C8;&#x306B;&#x3064;&#x3044;&#x3066;2&#x70B9;&#x304A;&#x9858;&#x3044;&#x304C;&#x6709;&#x308A;&#x307E;&#x3059;&#x3002;
&#x5E83;&#x677E;&gt; &#x4F55;&#x308C;&#x3082;&#x3001;emacs&#x4E0A;&#x306E;&#x3001;mhc-calendar &#x4E0A;&#x3067;&#x306E;&#x8A71;&#x3067;&#x3059;&#x3002;
&#x5E83;&#x677E;&gt; 
&#x5E83;&#x677E;&gt; 1. &#x6708;&#x66DC;&#x65E5;&#x3092;&#x9031;&#x982D;&#x306B;&#x6301;&#x3063;&#x3066;&#x6765;&#x305F;&#x3044;&#x3002;
&#x5E83;&#x677E;&gt; 
&#x5E83;&#x677E;&gt;     &#x4ED5;&#x4E8B;&#x67C4;&#x3001;&#x30E8;&#x30FC;&#x30ED;&#x30C3;&#x30D1;&#x306E;&#x65B9;&#x3068;&#x4ED8;&#x304D;&#x5408;&#x3046;&#x4E8B;&#x304C;&#x591A;&#x304F;&#x3001;&#x5F7C;&#x306E;&#x5730;&#x306E;&#x30C7;&#x30D5;&#x30A9;&#x30EB;&#x30C8;&#x3067;&#x3042;&#x308B;&#x3001;&#x6708;
&#x5E83;&#x677E;&gt;     &#x66DC;&#x3092;&#x9031;&#x982D;&#x306B;&#x6301;&#x3063;&#x3066;&#x3053;&#x308C;&#x306A;&#x3044;&#x3067;&#x3057;&#x3087;&#x3046;&#x304B;&#xFF1F;

# &#x4E16;&#x306E;&#x4E2D;&#x305D;&#x3046;&#x3044;&#x3046;&#x3082;&#x306E;&#x306A;&#x306E;&#x3067;&#x3059;&#x306D;&#x3002;

&#x5E83;&#x677E;&gt;     emacs &#x4ED8;&#x5C5E;&#x306E; calendar &#x3067;&#x306F;&#x8A2D;&#x5B9A;&#x3067;&#x304D;&#x308B;&#x4E8B;&#x3092;&#x767A;&#x898B;&#x3057;&#x307E;&#x3057;&#x305F;&#x3002;Mhc-calendar &#x3082;&#x540C;
&#x5E83;&#x677E;&gt;     &#x69D8;&#x304B;&#x3068;&#x601D;&#x3063;&#x3066;&#x3001;&#x63A2;&#x3057;&#x305F;&#x306E;&#x3067;&#x3059;&#x304C;&#x3001;&#x79C1;&#x306E;&#x77E5;&#x8B58;&#x3067;&#x306F;&#x7121;&#x7406;&#x3067;&#x3057;&#x305F;&#x3002;

&#x305D;&#x3046;&#x3044;&#x3046;&#x8A2D;&#x5B9A;&#x306F;&#x306A;&#x3044;&#x306E;&#x3067;&#x4F5C;&#x308A;&#x307E;&#x3057;&#x305F;&#x3002;CVS &#x306B;&#x306F; commit &#x3057;&#x307E;&#x3057;&#x305F;&#x304C;&#x3001;
diff &#x3092;&#x3064;&#x3051;&#x3066;&#x304A;&#x304D;&#x307E;&#x3059;&#x3002;&#x30C7;&#x30D5;&#x30A9;&#x30EB;&#x30C8;&#x306F;&#x65E5;&#x66DC;&#x65E5; = 0 &#x304B;&#x3089;&#x3067;&#x3059;&#x304C;&#x3001;
~/.emacs &#x3067;

    (setq mhc-calendar-start-day-of-week 1)

&#x3068;&#x3059;&#x308C;&#x3070;&#x6708;&#x66DC;&#x65E5;&#x304B;&#x3089;&#x306E;&#x8868;&#x793A;&#x306B;&#x306A;&#x308A;&#x307E;&#x3059;&#x3002;

# &#x610F;&#x5473;&#x304C;&#x3042;&#x308B;&#x304B;&#x306F;&#x308F;&#x304B;&#x308A;&#x307E;&#x305B;&#x3093;&#x304C;&#x3001;0&#x301C;6 &#x306E;&#x8A2D;&#x5B9A;&#x304C;&#x3067;&#x304D;&#x307E;&#x3059;&#x3002;
# &#x521D;&#x3081;&#x3066;&#x77E5;&#x3063;&#x305F;&#x306E;&#x3067;&#x3059;&#x304C;&#x3001;&#x897F;&#x66A6;1&#x5E74;1&#x6708;1&#x65E5;&#x306F;&#x6708;&#x66DC;&#x65E5;&#x306A;&#x306E;&#x3067;&#x3059;&#x306D;&#x3002;&#x3060;&#x304B;&#x3089;
# &#x6708;&#x66DC;&#x65E5;&#x304B;&#x3089;&#x306A;&#x3093;&#x3060;&#x308D;&#x3046;&#x306A;&#x3041;&#x3002;&#x304D;&#x3063;&#x3068;&#x3002;

&#x5E83;&#x677E;&gt; 2. CW &#x3092;&#x8868;&#x793A;&#x3057;&#x305F;&#x3044;
&#x5E83;&#x677E;&gt; 
&#x5E83;&#x677E;&gt;     CW (Calendar week number) &#x3068;&#x306F;&#x5E74;&#x521D;&#x304B;&#x3089;&#x306E;&#x901A;&#x7B97;&#x306E;&#x9031;&#x306E;&#x756A;&#x53F7;&#x3067;&#x3001;&#x30E8;&#x30FC;&#x30ED;&#x30C3;&#x30D1;&#x3067;
&#x5E83;&#x677E;&gt;     &#x306F;&#x3001;&#x4ED5;&#x4E8B;&#x306E;Due Date&#x7B49;&#x3092;&#x6C7A;&#x3081;&#x308B;&#x3068;&#x304D;&#x306B;&#x826F;&#x304F;&#x4F7F;&#x3063;&#x3066;&#x3044;&#x307E;&#x3059;&#x3002;&#x4E00;&#x822C;&#x7684;&#x306B;&#x30AB;&#x30EC;&#x30F3;&#x30C0;&#x306B;
&#x5E83;&#x677E;&gt;     &#x3082;&#x8868;&#x793A;&#x3055;&#x308C;&#x3066;&#x3044;&#x307E;&#x3059;&#x3002;&#x6163;&#x308C;&#x308B;&#x3068;&#x3001;&#x975E;&#x5E38;&#x306B;&#x4FBF;&#x5229;&#x306A;&#x3082;&#x306E;&#x3067;&#x3001;&#x305C;&#x3072;&#x540C;&#x3058;&#x3088;&#x3046;&#x306B;&#x8868;&#x793A;&#x3055;
&#x5E83;&#x677E;&gt;     &#x305B;&#x305F;&#x3044;&#x306E;&#x3067;&#x3059;&#x304C;&#x53EF;&#x80FD;&#x3067;&#x3057;&#x3087;&#x3046;&#x304B;&#x3002;
&#x5E83;&#x677E;&gt; 
&#x5E83;&#x677E;&gt;     Emacs &#x4ED8;&#x5C5E;&#x306E;Calendar&#x3067;&#x306F;&#x3001;8-column &#x8868;&#x793A;&#x306F;&#x51FA;&#x6765;&#x306A;&#x3044;&#x3088;&#x3046;&#x3067;&#x3059;&#x304C;&#x3001;menu &#x304B;&#x3089; 
&#x5E83;&#x677E;&gt;     goto ISO-date &#x304C;&#x9078;&#x3079;&#x308B;&#x306E;&#x3067;&#x3001;&#x95A2;&#x6570;&#x306F;&#x6301;&#x3063;&#x3066;&#x3044;&#x308B;&#x3088;&#x3046;&#x3067;&#x3059;&#x3002;

ISO &#x3063;&#x3066;&#x3044;&#x3046;&#x3050;&#x3089;&#x3044;&#x306A;&#x306E;&#x3067;&#x3061;&#x3083;&#x3063;&#x3068;&#x6C7A;&#x307E;&#x3063;&#x3066;&#x3044;&#x308B;&#x306E;&#x3060;&#x308D;&#x3046;&#x3068;&#x8ABF;&#x3079;&#x305F;&#x3068;&#x3053;
&#x308D;&#x3001;

<a  rel="nofollow" href="http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-list/35088">http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-list/35088</a>

&#x3067;&#x4EE5;&#x4E0B;&#x306E;&#x6587;&#x7AE0;&#x3092;&#x898B;&#x3064;&#x3051;&#x307E;&#x3057;&#x305F;&#x3002;

ruby&gt; &#xFF08;&#xFF11;&#xFF09;ISO 8601 &#x898F;&#x683C;&#x3067;&#x306F;&#xFF0C;&#x9031;&#x306E;&#x6700;&#x521D;&#x306E;&#x66DC;&#x65E5;&#x304C;&#x6708;&#x66DC;&#x3068;&#x3055;&#x308C;&#x3066;&#x3044;&#x307E;&#x3059;&#x3002;
ruby&gt; 
ruby&gt; &#xFF08;&#xFF12;&#xFF09;&#x300C;&#x5E74;&#x306E;&#x6700;&#x521D;&#x306E;&#x9031;&#x300D;&#x306F;&#x300C;&#x5C11;&#x306A;&#x304F;&#x3068;&#x3082; 4 &#x65E5;&#x4EE5;&#x4E0A;&#x3042;&#x308B;&#x6700;&#x521D;&#x306E;&#x9031;&#x3068;&#x3057;&#x3066;&#x5B9A;&#x7FA9;&#x3055;&#x308C;
ruby&gt; &#x308B;&#x300D;&#x3002;&#x3064;&#x307E;&#x308A;&#x300C;&#x5E74;&#x306E;&#x6700;&#x521D;&#x306E;&#x65E5;&#x304C;&#x91D1;&#x66DC;&#xFF0C;&#x571F;&#x66DC;&#xFF0C;&#x307E;&#x305F;&#x306F;&#x65E5;&#x66DC;&#x3067;&#x3042;&#x308B;&#x5834;&#x5408;&#xFF0C;&#x305D;&#x306E;&#x5E74;&#x306E;&#x6700;
ruby&gt; &#x521D;&#x306E; 3 &#x65E5;&#xFF0C;2 &#x65E5;&#xFF0C;&#x307E;&#x305F;&#x306F; 1 &#x65E5;&#x306B;&#x95A2;&#x3057;&#x3066;&#x306F;&#xFF0C;WeekOfTheYear &#x306F;&#x524D;&#x5E74;&#x306E;&#x6700;&#x5F8C;&#x306E;&#x9031;&#x3092;
ruby&gt; &#x8FD4;&#x3057;&#x307E;&#x3059;&#x300D;&#x3002;&#x300C;&#x5E74;&#x306E;&#x6700;&#x5F8C;&#x306E;&#x65E5;&#x304C;&#x6708;&#x66DC;&#xFF0C;&#x706B;&#x66DC;&#xFF0C;&#x307E;&#x305F;&#x306F;&#x6C34;&#x66DC;&#x3067;&#x3042;&#x308B;&#x5834;&#x5408;&#xFF0C;&#x305D;&#x306E;&#x5E74;&#x306E;&#x6700;
ruby&gt; &#x5F8C;&#x306E; 1 &#x65E5;&#xFF0C;2 &#x65E5;&#xFF0C;&#x307E;&#x305F;&#x306F; 3 &#x65E5;&#x306B;&#x95A2;&#x3057;&#x3066;&#x306F;&#xFF0C;WeekOfTheYear &#x306F; 1&#xFF08;&#x7FCC;&#x5E74;&#x306E;&#x6700;&#x521D;&#x306E;
ruby&gt; &#x9031;&#xFF09;&#x3092;&#x8FD4;&#x3057;&#x307E;&#x3059;&#x300D;&#x3002;
ruby&gt; 
ruby&gt; --
ruby&gt; &#x3010;ISO 8601 &#x898F;&#x683C;&#x306E;&#x300C;&#x5E74;&#x306E;&#x6700;&#x521D;&#x306E;&#x9031;&#x300D;&#x3011;
ruby&gt; N:\&gt;ruby -rdate -e 'puts Date::new(2000,01,2).cweek'
ruby&gt; 52
ruby&gt; 
ruby&gt; N:\&gt;ruby -rdate -e 'puts Date::new(2002,12,30).cweek'
ruby&gt; 1

&#x3075;&#x3080;&#x3075;&#x3080;&#x3002;&#x3067;&#x3082;&#x3046;&#x5C11;&#x3057;&#x8ABF;&#x3079;&#x305F;&#x3068;&#x3053;&#x308D;&#x3001;

JISX&gt; JIS X 0301
JISX&gt; 
JISX&gt; &#x65E5;&#x672C;&#x5DE5;&#x696D;&#x898F;&#x683C; JIS X 0301-1992. &#x300C;&#x65E5;&#x4ED8;&#x53CA;&#x3073;&#x6642;&#x523B;&#x306E;&#x8868;&#x8A18;&#x300D;.
JISX&gt; 
JISX&gt; ISO 8601:1988 (Data elements and interchange formats --- Information interchange ---
JISX&gt; Representation of dates and times) &#x306E;&#x7FFB;&#x8A33;.

&#x3067;&#x3059;&#x3063;&#x3066;&#x3002;&#x4ECA;&#x5EA6;&#x8AAD;&#x3082;&#x3046;&#x3002;&#x3068;&#x3044;&#x3046;&#x3053;&#x3068;&#x306F;&#x3001;01/01/1995 &#x306F;&#x65E5;&#x66DC;&#x65E5;&#x3060;&#x304B;&#x3089;&#x3001;

[shirai@pepper:~/]% ruby -rdate -e 'puts Date::new(1995,01,01).cweek'
52
[shirai@pepper:~/]% ruby -rdate -e 'puts Date::new(1995,01,02).cweek'
1

&#x4E16;&#x306E;&#x4E2D;&#x305D;&#x3093;&#x306A;&#x3082;&#x306E;&#x3060;&#x3063;&#x305F;&#x3068;&#x306F;&#x77E5;&#x308A;&#x307E;&#x305B;&#x3093;&#x3067;&#x3057;&#x305F;&#x3002;&#x306A;&#x304A;&#x3001;

&#x5E83;&#x677E;&gt;     &#x56E0;&#x307F;&#x306B;&#x3001;&#x8868;&#x793A;&#x306F; 8-column &#x306B;&#x306A;&#x308A;&#x3001;
&#x5E83;&#x677E;&gt;         CW Mo Tu We Th Fr Sa Su
&#x5E83;&#x677E;&gt;     &#x3068;&#x306A;&#x308A;&#x307E;&#x3059;&#x3002;

&#x3053;&#x306E;&#x5F62;&#x5F0F;&#x3067;&#x8868;&#x793A;&#x3067;&#x304D;&#x308B;&#x304B;&#x3069;&#x3046;&#x304B;&#x306F;&#x3001;&#x3061;&#x3087;&#x3063;&#x3068;&#x4E0D;&#x660E;(&#x826F;&#x304F;&#x899A;&#x3048;&#x3066;&#x3044;&#x306A;&#x3044;)&#x306A;
&#x306E;&#x3067;&#x3001;&#x6700;&#x60AA;&#x3001;

       August 2002 (30-35) &lt;= &#x3053;&#x3053;&#x306E;&#x3068;&#x3053;&#x308D;
      &#x65E5; &#x6708; &#x706B; &#x6C34; &#x6728; &#x91D1; &#x571F;
                   1  2  3
       4  5  6  7  8  9 10
      11 12 13 14 15 16 17
      18 19 20 21 22 23 24
      25 26 27 28 29 30 31

&#x307F;&#x305F;&#x3044;&#x306B;&#x306A;&#x308B;&#x304B;&#x3082;&#x3057;&#x308C;&#x307E;&#x305B;&#x3093;&#x304C;&#x3001;&#x5C11;&#x3005;(&#x6C17;&#x9577;&#x306B;&#xFF1F;)&#x304A;&#x5F85;&#x3061;&#x4E0B;&#x3055;&#x3044;&#x3002;

&gt; &#x6211;&#x4FAD;&#x3070;&#x304B;&#x308A;&#x3067;&#x3001;&#x7533;&#x3057;&#x8A33;&#x3042;&#x308A;&#x307E;&#x305B;&#x3093;&#x304C;&#x3001;&#x3088;&#x308D;&#x3057;&#x304F;&#x304A;&#x9858;&#x3044;&#x3044;&#x305F;&#x3057;&#x307E;&#x3059;&#x3002;

## &#x304A;&#x5BA2;&#x69D8;&#x306F;&#x795E;&#x69D8;&#x3067;&#x3059;&#x3002;:-)

-- 
&#x767D;&#x4E95;&#x79C0;&#x884C; (<a  rel="nofollow" href="mailto:shirai@xxxxxxxxxxxxx">mailto:shirai@xxxxxxxxxxxxx</a>)
</pre><pre>? cal.diff
Index: mhc-calendar.el
===================================================================
RCS file: /cvsroot/mhc/emacs/mhc-calendar.el,v
retrieving revision 1.29
diff -u -r1.29 mhc-calendar.el
--- mhc-calendar.el	2002/09/05 04:28:23	1.29
+++ mhc-calendar.el	2002/09/19 03:24:14
@@ -14,7 +14,33 @@
   :group 'mhc
   :type 'character)
 
-(defcustom mhc-calendar-day-strings [&quot;Su&quot; &quot;Mo&quot; &quot;Tu&quot; &quot;We&quot; &quot;Th&quot; &quot;Fr&quot; &quot;Sa&quot;]
+(defcustom mhc-calendar-start-day-of-week 0
+  &quot;*Day of the week as the start of the week.&quot;
+  :group 'mhc
+  :type '(choice (const :tag &quot;Sunday&quot; 0)
+		 (const :tag &quot;Monday&quot; 1)
+		 (const :tag &quot;Tuesday&quot; 2)
+		 (const :tag &quot;Wednesday&quot; 3)
+		 (const :tag &quot;Thursday&quot; 4)
+		 (const :tag &quot;Friday&quot; 5)
+		 (const :tag &quot;Saturday&quot; 6)))
+
+(defcustom mhc-calendar-day-strings
+  (cond
+   ((= mhc-calendar-start-day-of-week 0)
+    [&quot;Su&quot; &quot;Mo&quot; &quot;Tu&quot; &quot;We&quot; &quot;Th&quot; &quot;Fr&quot; &quot;Sa&quot;])
+   ((= mhc-calendar-start-day-of-week 1)
+    [&quot;Mo&quot; &quot;Tu&quot; &quot;We&quot; &quot;Th&quot; &quot;Fr&quot; &quot;Sa&quot; &quot;Su&quot;])
+   ((= mhc-calendar-start-day-of-week 2)
+    [&quot;Tu&quot; &quot;We&quot; &quot;Th&quot; &quot;Fr&quot; &quot;Sa&quot; &quot;Su&quot; &quot;Mo&quot;])
+   ((= mhc-calendar-start-day-of-week 3)
+    [&quot;We&quot; &quot;Th&quot; &quot;Fr&quot; &quot;Sa&quot; &quot;Su&quot; &quot;Mo&quot; &quot;Tu&quot;])
+   ((= mhc-calendar-start-day-of-week 4)
+    [&quot;Th&quot; &quot;Fr&quot; &quot;Sa&quot; &quot;Su&quot; &quot;Mo&quot; &quot;Tu&quot; &quot;We&quot;])
+   ((= mhc-calendar-start-day-of-week 5)
+    [&quot;Fr&quot; &quot;Sa&quot; &quot;Su&quot; &quot;Mo&quot; &quot;Tu&quot; &quot;We&quot; &quot;Th&quot;])
+   (t
+    [&quot;Sa&quot; &quot;Su&quot; &quot;Mo&quot; &quot;Tu&quot; &quot;We&quot; &quot;Th&quot; &quot;Fr&quot;]))
   &quot;*Vector of \&quot;day of week\&quot; for 3-month calendar header.
 This vector must have seven elements
 and each element must have \&quot;strings of two columns\&quot;.
@@ -357,9 +383,14 @@
       (mhc-misc-insert-rectangle rect))))
 
 (defun mhc-calendar-make-header (date)
-  (mhc-date-format date &quot;   %s %04d&quot;
-		   (mhc-date-digit-to-mm-string mm t) yy))
-
+  (let ((ret (mhc-date-format date &quot;%s %04d&quot;
+			      (mhc-date-digit-to-mm-string mm t) yy)))
+    (if (mhc-date-yymm= (mhc-date-now) date)
+	(mhc-face-put
+	 ret (mhc-face-get-today-face 'mhc-calendar-face-saturday))
+      (mhc-face-put ret 'mhc-calendar-face-saturday))
+    (concat &quot;   &quot; ret)))
+  
 (defun mhc-calendar-make-header-ja (date)
   (let ((ret (mhc-date-format date &quot;%04d&#x5E74;%2d&#x6708;&quot; yy mm)))
     (if (mhc-date-yymm= (mhc-date-now) date)
@@ -377,11 +408,16 @@
 		      (concat separator &quot; &quot;
 			      (funcall mhc-calendar-header-function
 				       (or date today)))))
-	 (i (mhc-day-day-of-week (car days)))
-	 week color)
-    (while (&gt; i 0)
-      (setq week (cons &quot;  &quot; week)
-	    i (1- i)))
+	 (endday (nth mhc-calendar-start-day-of-week '(6 0 1 2 3 4 5)))
+	 (start (mhc-day-day-of-week (car days)))
+	 (i 0) week color)
+    (unless (= endday 6)
+      (setq start (+ start 6))
+      (when (&gt; start 6)
+	(setq start (- start 7))))
+    (while (&lt; i start)
+      (setq week (cons &quot;  &quot; week))
+      (setq i (1+ i)))
     (while days
       (setq color
 	    (cond
@@ -398,7 +434,7 @@
 	(setq color (mhc-face-get-busy-face color)))
       (setq week (cons (format &quot;%2d&quot; (mhc-day-day-of-month (car days))) week))
       (when color (mhc-face-put (car week) color))
-      (when (= 6 (mhc-day-day-of-week (car days)))
+      (when (= endday (mhc-day-day-of-week (car days)))
 	(setq month (cons (mapconcat
 			   (function identity)
 			   (cons separator (nreverse week))
</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="01627" href="msg01627.html">[mhc:01628] Re: &#x30AB;&#x30EC;&#x30F3;&#x30C0;&#x306E;&#x30D5;&#x30A9;&#x30FC;&#x30DE;&#x30C3;&#x30C8;</a></strong>
<ul><li><em>From:</em> &#x9BC9;&#x6C5F;&#x82F1;&#x9686;</li></ul></li>
<li><strong><a name="01628" href="msg01628.html">[mhc:01629] Re: &#x30AB;&#x30EC;&#x30F3;&#x30C0;&#x306E;&#x30D5;&#x30A9;&#x30FC;&#x30DE;&#x30C3;&#x30C8;</a></strong>
<ul><li><em>From:</em> Takashi Hiromatsu</li></ul></li>
<li><strong><a name="01629" href="msg01629.html">[mhc:01630] Re: &#x30AB;&#x30EC;&#x30F3;&#x30C0;&#x306E;&#x30D5;&#x30A9;&#x30FC;&#x30DE;&#x30C3;&#x30C8;</a></strong>
<ul><li><em>From:</em> &#x9BC9;&#x6C5F;&#x82F1;&#x9686;</li></ul></li>
<li><strong><a name="01630" href="msg01630.html">[mhc:01631] Re: &#x30AB;&#x30EC;&#x30F3;&#x30C0;&#x306E;&#x30D5;&#x30A9;&#x30FC;&#x30DE;&#x30C3;&#x30C8;</a></strong>
<ul><li><em>From:</em> Yoshinari Nomura</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="01625" href="msg01625.html">[mhc:01626] &#x30AB;&#x30EC;&#x30F3;&#x30C0;&#x306E;&#x30D5;&#x30A9;&#x30FC;&#x30DE;&#x30C3;&#x30C8;</a></strong>
<ul><li><em>From:</em> Takashi Hiromatsu</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg01625.html">[mhc:01626] &#x30AB;&#x30EC;&#x30F3;&#x30C0;&#x306E;&#x30D5;&#x30A9;&#x30FC;&#x30DE;&#x30C3;&#x30C8;</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg01627.html">[mhc:01628] Re: &#x30AB;&#x30EC;&#x30F3;&#x30C0;&#x306E;&#x30D5;&#x30A9;&#x30FC;&#x30DE;&#x30C3;&#x30C8;</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg01625.html">[mhc:01626] &#x30AB;&#x30EC;&#x30F3;&#x30C0;&#x306E;&#x30D5;&#x30A9;&#x30FC;&#x30DE;&#x30C3;&#x30C8;</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg01627.html">[mhc:01628] Re: &#x30AB;&#x30EC;&#x30F3;&#x30C0;&#x306E;&#x30D5;&#x30A9;&#x30FC;&#x30DE;&#x30C3;&#x30C8;</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#01626"><strong>Date</strong></a></li>
<li><a href="threads.html#01626"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
