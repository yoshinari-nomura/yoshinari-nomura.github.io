<!-- MHonArc v2.6.16 -->
<!--X-Subject: [mhc:02220] patch for mhc2ol.in -->
<!--X-From-R13: @AUGQVW Khfhxr <abthabthNzin.ovtybor.ar.wc> -->
<!--X-Date: Mon, 02 Oct 2006 18:05:55 +0900 (JST) -->
<!--X-Message-Id: 20061002.180555.68558599.nogunogu@mva.biglobe.ne.jp -->
<!--X-Content-Type: multipart/mixed -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>[mhc:02220] patch for mhc2ol.in</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg02218.html">Date Prev</a>][<a href="msg02220.html">Date Next</a>][<a href="msg02218.html">Thread Prev</a>][<a href="msg02220.html">Thread Next</a>][<a href="maillist.html#02219">Date Index</a>][<a href="threads.html#02219">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[mhc:02220] patch for mhc2ol.in</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:mhc@DOMAIN.HIDDEN">mhc@xxxxxxxxxxxxx</a></li>
<li><em>Subject</em>: [mhc:02220] patch for mhc2ol.in</li>
<li><em>From</em>: NOGUCHI Yusuke &lt;<a href="mailto:nogunogu@DOMAIN.HIDDEN">nogunogu@xxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Mon, 02 Oct 2006 18:05:55 +0900 (JST)</li>
<li><em>Delivered-to</em>: <a href="mailto:mhc@DOMAIN.HIDDEN">mhc@xxxxxxxxxxxxx</a></li>
<li><em>List-help</em>: &lt;<a href="mailto:mhc-ctl@quickhack.net?body=help">mailto:mhc-ctl@quickhack.net?body=help</a>&gt;</li>
<li><em>List-id</em>: mhc.quickhack.net</li>
<li><em>List-owner</em>: &lt;<a href="mailto:mhc-admin@quickhack.net">mailto:mhc-admin@quickhack.net</a>&gt;</li>
<li><em>List-post</em>: &lt;<a href="mailto:mhc@quickhack.net">mailto:mhc@quickhack.net</a>&gt;</li>
<li><em>List-software</em>: fml [fml 4.0.3 release (20011202/4.0.3)]</li>
<li><em>List-unsubscribe</em>: &lt;<a href="mailto:mhc-ctl@quickhack.net?body=unsubscribe">mailto:mhc-ctl@quickhack.net?body=unsubscribe</a>&gt;</li>
<li><em>Reply-to</em>: <a href="mailto:mhc@DOMAIN.HIDDEN">mhc@xxxxxxxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>&#x91CE;&#x53E3;&#x3067;&#x3059;&#x3002;

&#x4EE5;&#x524D;&#x3053;&#x3061;&#x3089;&#x3067;&#x30A2;&#x30C9;&#x30D0;&#x30A4;&#x30B9;&#x3092;&#x3044;&#x305F;&#x3060;&#x304D;&#x3001;mhc &#x3067;&#x30B9;&#x30B1;&#x30B8;&#x30E5;&#x30FC;&#x30EB;&#x306E;&#x767B;&#x9332;/&#x524A;&#x9664;&#x3092;&#x884C;
&#x3046;&#x3068;&#x81EA;&#x52D5;&#x7684;&#x306B; Outlook &#x3078;&#x540C;&#x671F;&#x3059;&#x308B;&#x3088;&#x3046;&#x306B;&#x3001;&#x4EE5;&#x4E0B;&#x306E; hook &#x3092;&#x3057;&#x304B;&#x3051;&#x3066;&#x3044;&#x307E;&#x3059;&#x3002;

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
(add-hook 'mhc-draft-finish-hook
	    (lambda ()
	        (shell-command &quot;/usr/bin/ruby /usr/bin/mhc2ol -N -H &amp;&quot;)))
(add-hook 'mhc-delete-file-hook
	    (lambda ()
	        (shell-command &quot;/usr/bin/ruby /usr/bin/mhc2ol -N -H &amp;&quot;)))
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

&#x73FE;&#x884C;&#x306E; mhc2ol &#x3092;&#x5B9F;&#x884C;&#x3059;&#x308B;&#x3068;&#x3001;&#x3059;&#x3067;&#x306B;&#x904E;&#x53BB;3&#x30F6;&#x6708;&#x5206;&#x306E;&#x5B8C;&#x4E86;&#x3057;&#x305F;&#x30B9;&#x30B1;&#x30B8;&#x30E5;&#x30FC;&#x30EB;
(Outlook &#x5074;&#x306E;&#x64CD;&#x4F5C;&#x3067;&#x3001;&#x30A2;&#x30E9;&#x30FC;&#x30E0;&#x89E3;&#x9664;&#x6E08;&#x307F;)&#x304C;&#x4E0A;&#x66F8;&#x304D;&#x3055;&#x308C;&#x3066;&#x3001;&#x300C;&#x904E;&#x53BB;&#x306E;&#x30A2;&#x30E9;&#x30FC;&#x30E0;&#x300D;
&#x304C;&#x3069;&#x3070;&#x3063;&#x3068;&#x51FA;&#x3066;&#x304D;&#x3066;&#x3057;&#x307E;&#x3046;&#x3068;&#x3044;&#x3046;&#x554F;&#x984C;&#x304C;&#x3042;&#x308A;&#x307E;&#x3059;&#x3002;

&#x305D;&#x3053;&#x3067;&#x3001;mhc2ol &#x3067;&#x306B;&#x4EE5;&#x4E0B;&#x306E;&#x5909;&#x66F4;&#x3092;&#x52A0;&#x3048;&#x3066;&#x307F;&#x307E;&#x3057;&#x305F;&#x3002;

&quot;-A&quot; &#x30AA;&#x30D7;&#x30B7;&#x30E7;&#x30F3;&#x3092;&#x65B0;&#x8A2D;&#x3057;&#x307E;&#x3057;&#x305F;&#x3002;
&quot;-A&quot;&#x3092;&#x3064;&#x3051;&#x308B;&#x3068;
   mhc2ol &#x3067; Export &#x3059;&#x308B;&#x969B;&#x306B;&#x300C;&#x904E;&#x53BB;&#x5206;&#x306E;&#x30B9;&#x30B1;&#x30B8;&#x30E5;&#x30FC;&#x30EB;&#x300D;&#x306B;&#x3064;&#x3044;&#x3066;&#x306F;&#x300C;&#x30A2;&#x30E9;&#x30FC;&#x30E0;&#x8A2D;
   &#x5B9A;(X-SC-Alarm: )&#x300D;&#x3092;&#x7121;&#x52B9;&#x306B;&#x3057;&#x3066; Export &#x3059;&#x308B;&#x3002;
&#x3068;&#x3044;&#x3046;&#x52D5;&#x4F5C;&#x306B;&#x306A;&#x308A;&#x307E;&#x3059;&#x3002;(&#x30AA;&#x30D7;&#x30B7;&#x30E7;&#x30F3;&#x3092;&#x6307;&#x5B9A;&#x3057;&#x306A;&#x3051;&#x308C;&#x3070;&#x3001;&#x5F93;&#x6765;&#x901A;&#x308A;&#x306E;&#x52D5;&#x4F5C;)

&#x4EE5;&#x4E0A;&#x3001;&#x3054;&#x691C;&#x8A0E;&#x3044;&#x305F;&#x3060;&#x3051;&#x308C;&#x3070;&#x5E78;&#x3044;&#x3067;&#x3059;&#x3002;
-- 
NOGUCHI Yusuke &lt;nogunogu@xxxxxxxxxxxxxxxxx&gt;



</pre><pre>*** mhc2ol.in.org	Mon May  2 07:55:08 2005
--- mhc2ol.in	Mon Oct  2 17:46:20 2006
***************
*** 65,70 ****
--- 65,78 ----
        [@stime, @etime]
      end
  
+     def get_sdatetime
+       Time .local(@sdate. y, @sdate. m, @sdate .d, @stime .hh, @stime .mm)
+     end
+ 
+     def get_edatetime
+       Time .local(@edate. y, @edate. m, @edate .d, @etime .hh, @etime .mm)
+     end
+ 
      def handle_recurrence(ol_appoint)
      end
  
***************
*** 183,189 ****
  
  def usage
    print '
! usage: mhc2ol [-a | -i | -d | -N] [-H] [-n] [-s] [-m] [-r dir] [-c category] [YYYYMMDD-yyyymmdd]
  
    mhc2ol -- Add/Copy mhc articles to Outlook.
  
--- 191,197 ----
  
  def usage
    print '
! usage: mhc2ol [-a | -i | -d | -N] [-A] [-H] [-n] [-s] [-m] [-r dir] [-c category] [YYYYMMDD-yyyymmdd]
  
    mhc2ol -- Add/Copy mhc articles to Outlook.
  
***************
*** 205,210 ****
--- 213,219 ----
               ~/Mail/schedule
      -c     : Copy only the mhc articles of which the category
               matches the specified regexp.
+     -A     : Disable reminder if the mhc article already has been passed.
  
      YYYYMMDD-yyyymmdd : set a start and end date of scanning mhc.
                          if omitted, scan from 3 months ago to
***************
*** 341,346 ****
--- 350,356 ----
    @@flag_export_part = 'all' # 'all' || 'body_only'
    @@flag_noharm = false
    @@flag_timestamp = false
+   @@flag_disable_passed_sch = false
    @@mhc_category_name = 'MHC-sch'
    @@additional_category = false
  
***************
*** 475,482 ****
  
        # a reminder is valid for a future schedule.
        if sch .alarm() != nil then
! 	appoint .ReminderSet = true
! 	appoint .ReminderMinutesBeforeStart = sch .alarm() / 60
        else
  	appoint .ReminderSet = false
        end
--- 485,496 ----
  
        # a reminder is valid for a future schedule.
        if sch .alarm() != nil then
! 	if period .get_sdatetime &gt;= Time .now &amp;&amp; $flag_disable_passed_sch
! 	  appoint .ReminderSet = true
! 	  appoint .ReminderMinutesBeforeStart = sch .alarm() / 60
! 	else
! 	  appoint .ReminderSet = false
! 	end
        else
  	appoint .ReminderSet = false
        end
***************
*** 752,757 ****
--- 766,775 ----
      @@flag_additional_category = flag
    end
  
+   def Exporter.set_flag_disable_passed_sch(flag)
+     @@set_flag_disable_passed_sch = flag
+   end
+ 
    def Exporter.to_ol_date(date)
      format(&quot;%4d/%02d/%02d&quot;, date .y(), date .m(), date .d()) if date
    end
***************
*** 775,780 ****
--- 793,799 ----
  $flag_separation = false
  $flag_discreet = false
  $flag_additional_category = false
+ $flag_disable_passed_sch = false
  
  while ARGV .length &gt; 0
    case ARGV[0]
***************
*** 804,809 ****
--- 823,830 ----
      $flag_separation = true
    when '-m'
      $flag_additional_category = true
+   when '-A'
+     $flag_disable_passed_sch = true
    else
      usage()
    end
***************
*** 850,855 ****
--- 871,877 ----
  Exporter .set_flag_noharm($flag_noharm)
  Exporter .set_flag_timestamp($flag_timestamp)
  Exporter .set_flag_additional_category($flag_additional_category)
+ Exporter .set_flag_disable_passed_sch($flag_disable_passed_sch)
  exporter = Exporter .new(mdb, outlook)
  exporter .set_category_regexp($flag_category_regexp)
  exporter .delete_ol_schedules()
</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="02220" href="msg02220.html">[mhc:02221] Re: patch for mhc2ol.in</a></strong>
<ul><li><em>From:</em> NOGUCHI Yusuke</li></ul></li>
<li><strong><a name="02222" href="msg02222.html">[mhc:02223] Re: patch for mhc2ol.in</a></strong>
<ul><li><em>From:</em> MIYOSHI Masanori</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg02218.html">[mhc:02219] Re: pilot-link 0.12.1</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg02220.html">[mhc:02221] Re: patch for mhc2ol.in</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg02218.html">[mhc:02219] Re: pilot-link 0.12.1</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg02220.html">[mhc:02221] Re: patch for mhc2ol.in</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#02219"><strong>Date</strong></a></li>
<li><a href="threads.html#02219"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
