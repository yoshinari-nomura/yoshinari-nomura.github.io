<!-- MHonArc v2.6.16 -->
<!--X-Subject: [mhc:02010] Re: import =?ISO&#45;2022&#45;JP?B?GyRCO34kTkZ+Tk89Zz14JEskRCQkJEYbKEI=?= -->
<!--X-From-R13: Vvqrlhxv EVWDOW (=?vfb&#45;2022&#45;wc?P?UlDQD3WjLw0bAHCoYSW=?=) <fuvenvNdhvpxunpx.arg> -->
<!--X-Date: Fri, 14 Jan 2005 14:58:27 +0900 (JST) -->
<!--X-Message-Id: 20050114.145827.68547032.shirai.hideyuki@rdmg.mgcs.mei.co.jp -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20050114.135326.68541333.nogunogu@mva.biglobe.ne.jp -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>[mhc:02010] Re: import &#x6642;&#x306E;&#x5165;&#x529B;&#x9806;&#x5E8F;&#x306B;&#x3064;&#x3044;&#x3066;</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg02008.html">Date Prev</a>][<a href="msg02010.html">Date Next</a>][<a href="msg02008.html">Thread Prev</a>][<a href="msg02010.html">Thread Next</a>][<a href="maillist.html#02009">Date Index</a>][<a href="threads.html#02009">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[mhc:02010] Re: import &#x6642;&#x306E;&#x5165;&#x529B;&#x9806;&#x5E8F;&#x306B;&#x3064;&#x3044;&#x3066;</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:mhc@DOMAIN.HIDDEN">mhc@xxxxxxxxxxxxx</a></li>
<li><em>Subject</em>: [mhc:02010] Re: import &#x6642;&#x306E;&#x5165;&#x529B;&#x9806;&#x5E8F;&#x306B;&#x3064;&#x3044;&#x3066;</li>
<li><em>From</em>: Hideyuki SHIRAI (&#x767D;&#x4E95;&#x79C0;&#x884C;) &lt;<a href="mailto:shirai@DOMAIN.HIDDEN">shirai@xxxxxxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Fri, 14 Jan 2005 14:58:27 +0900 (JST)</li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:20050114.135326.68541333.nogunogu@DOMAIN.HIDDEN">20050114.135326.68541333.nogunogu@xxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Organization</em>: QuickHackers, Tokyo, JAPAN</li>
<li><em>References</em>: &lt;<a href="mailto:20050114.135326.68541333.nogunogu@DOMAIN.HIDDEN">20050114.135326.68541333.nogunogu@xxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Reply-to</em>: <a href="mailto:mhc@DOMAIN.HIDDEN">mhc@xxxxxxxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>From: NOGUCHI Yusuke &lt;nogunogu@xxxxxxxxxxxxxxxxx&gt; &#x3055;&#x3093;&#x66F0;&#x304F;
Subject: [mhc:02009] import &#x6642;&#x306E;&#x5165;&#x529B;&#x9806;&#x5E8F;&#x306B;&#x3064;&#x3044;&#x3066;
Message-ID: &lt;20050114.135326.68541333.nogunogu@xxxxxxxxxxxxxxxxx&gt;
Date: Fri, 14 Jan 2005 13:53:26 +0900 (JST)

&gt; &#x591A;&#x5206;&#x306B;&#x300C;&#x597D;&#x307F;&#x306E;&#x554F;&#x984C;&#x300D;&#x3068;&#x8A00;&#x308F;&#x308C;&#x3066;&#x3057;&#x307E;&#x3044;&#x305D;&#x3046;&#x3067;&#x3059;&#x304C;...

&#x306F;&#x3044;&#x3001;&#x5B8C;&#x74A7;&#x306B;&#x300C;&#x597D;&#x307F;&#x306E;&#x554F;&#x984C;&#x300D;&#x3067;&#x3059;&#x306D; :-)

&#x3060;&#x3051;&#x3069;&#x3001;&#x3053;&#x3046;&#x3044;&#x3046;&#x30A4;&#x30F3;&#x30BF;&#x30D5;&#x30A7;&#x30FC;&#x30B9;&#x306E;&#x90E8;&#x5206;&#x306F;&#x300C;&#x81EA;&#x5206;&#x597D;&#x307F;&#x300D;&#x304C;&#x4E00;&#x756A;&#x3067;&#x3059;&#x304B;&#x3089;&#x3001;
&#x8AB0;&#x3067;&#x3082; OK &#x306B;&#x306A;&#x308B;&#x3088;&#x3046;&#x306B;&#x5909;&#x66F4;&#x53EF;&#x80FD;&#x306B;&#x3059;&#x308B;&#x3001;&#x304C;&#x6B63;&#x89E3;&#x3060;&#x3068;&#x601D;&#x3044;&#x307E;&#x3059;&#x3002;

&gt;   [data] -&gt; [time] -&gt; [location] -&gt; [subject] -&gt; [catetory] -&gt; [alarm]
&gt; &#x3068;&#x3059;&#x308B;&#x3088;&#x3046;&#x306B;&#x3057;&#x3066;&#x307F;&#x307E;&#x3057;&#x305F;&#x3002;

(setq mhc-input-sequences '(date time location subject category alarm))
&#x3068;&#x3059;&#x308B;&#x3068;&#x3001;&#x305D;&#x3046;&#x306A;&#x308A;&#x307E;&#x3059;&#x3002;

# &#x3061;&#x3087;&#x3063;&#x3068;&#x96D1;&#x304B;&#x306A;&#x3041;&#x3068;&#x3082;&#x601D;&#x3046;&#x306E;&#x3067;&#x3001;&#x6B21;&#x56DE;&#x306E;&#x73FE;&#x5B9F;&#x9003;&#x907F;&#x3067;&#x898B;&#x76F4;&#x3057;&#x3066;&#x304A;&#x304D;&#x307E;&#x3059;&#x3002;

-- 
&#x767D;&#x4E95;&#x79C0;&#x884C; (<a  rel="nofollow" href="mailto:shirai@xxxxxxxxxxxxx">mailto:shirai@xxxxxxxxxxxxx</a>)


Index: mhc.el
===================================================================
RCS file: /cvsroot/mhc/emacs/mhc.el,v
retrieving revision 1.87
diff -u -u -r1.87 mhc.el
--- mhc.el	7 Oct 2004 10:38:00 -0000	1.87
+++ mhc.el	14 Jan 2005 05:53:43 -0000
@@ -550,6 +550,17 @@
 
 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
 ;; import, edit, delete, modify
+
+(defcustom mhc-input-sequences '(date time subject location category alarm)
+  &quot;*Sequence of the inputs.&quot;
+  :group 'mhc
+  :type '(repeat (choice (const :tag &quot;Date&quot; date)
+			 (const :tag &quot;Time&quot; time)
+			 (const :tag &quot;Subject&quot; subject)
+			 (const :tag &quot;Location&quot; location)
+			 (const :tag &quot;Category&quot; category)
+			 (const :tag &quot;Alarm&quot; alarm))))
+
 (defun mhc-edit (&amp;optional import-buffer)
   &quot;Edit a new schedule.
 If optional argument IMPORT-BUFFER is specified, import its content.
@@ -591,45 +602,56 @@
 					  (cdr import-buffer)
 					import-buffer))
 				     (mhc-parse-buffer)))
-			 (schedule (car (mhc-record-schedules original))))
-		    ;; input date
-		    (setq date
-			  (mhc-input-day &quot;Date: &quot;
-					 current-date
-					 (mhc-guess-date)))
-		    ;; input time
-		    (setq time
-			  (mhc-input-time &quot;Time: &quot;
-					  (mhc-schedule-time-as-string
-					   schedule)
-					  (mhc-guess-time
-					   (mhc-minibuf-candidate-nth-begin))))
-		    ;; input subject
-		    (setq subject
-			  (mhc-input-subject
-			   &quot;Subject: &quot;
-			   (mhc-misc-sub
-			    (or (mhc-record-subject original)
-				(mhc-header-narrowing
-				  (mhc-header-get-value &quot;subject&quot;)))
-			    &quot;^\\(Re:\\)? *\\(\\[[^\]]+\\]\\)? *&quot;
-			    &quot;&quot;)))
-		    ;; input location
-		    (setq location
-			  (mhc-input-location
-			   &quot;Location: &quot;
-			   (mhc-schedule-location schedule)))
-		    ;; input category
-		    (setq category
-			  (mhc-input-category
-			   &quot;Category: &quot;
-			   (mhc-schedule-categories-as-string schedule)))
-		    ;; input alarm
-		    (if mhc-ask-alarm
-			(setq alarm
-			      (mhc-input-alarm
-			       &quot;Alarm: &quot;
-			       mhc-default-alarm)))
+			 (schedule (car (mhc-record-schedules original)))
+			 (inputs (copy-sequence mhc-input-sequences))
+			 input)
+		    (while (setq input (car inputs))
+		      (setq inputs (delq input inputs))
+		      (cond
+		       ((eq input 'date)
+			;; input date
+			(setq date
+			      (mhc-input-day &quot;Date: &quot;
+					     current-date
+					     (mhc-guess-date))))
+		       ((eq input 'time)
+			;; input time
+			(setq time
+			      (mhc-input-time &quot;Time: &quot;
+					      (mhc-schedule-time-as-string
+					       schedule)
+					      (mhc-guess-time
+					       (mhc-minibuf-candidate-nth-begin)))))
+		       ((eq input 'subject)
+			;; input subject
+			(setq subject
+			      (mhc-input-subject
+			       &quot;Subject: &quot;
+			       (mhc-misc-sub
+				(or (mhc-record-subject original)
+				    (mhc-header-narrowing
+				      (mhc-header-get-value &quot;subject&quot;)))
+				&quot;^\\(Re:\\)? *\\(\\[[^\]]+\\]\\)? *&quot;
+				&quot;&quot;))))
+		       ((eq input 'location)
+			;; input location
+			(setq location
+			      (mhc-input-location
+			       &quot;Location: &quot;
+			       (mhc-schedule-location schedule))))
+		       ((eq input 'category)
+			;; input category
+			(setq category
+			      (mhc-input-category
+			       &quot;Category: &quot;
+			       (mhc-schedule-categories-as-string schedule))))
+		       ;; input alarm
+		       ((eq input 'alarm)
+			(if mhc-ask-alarm
+			    (setq alarm
+				  (mhc-input-alarm
+				   &quot;Alarm: &quot;
+				   mhc-default-alarm))))))
 		    ;;
 		    (setq priority (mhc-schedule-priority schedule)))
 		;; Answer was no.
@@ -639,13 +661,24 @@
 		(setq succeed nil)
 		(kill-buffer draft-buffer)))
 	  ;; No import (it succeeds).
-	  (setq date (mhc-input-day &quot;Date: &quot; current-date)
-		time (mhc-input-time &quot;Time: &quot;)
-		subject (mhc-input-subject &quot;Subject: &quot;)
-		location (mhc-input-location &quot;Location: &quot;)
-		category (mhc-input-category &quot;Category: &quot;))
-	  (if mhc-ask-alarm
-	      (setq alarm (mhc-input-alarm &quot;Alarm: &quot; mhc-default-alarm))))
+	  (let ((inputs (copy-sequence mhc-input-sequences))
+		input)
+	    (while (setq input (car inputs))
+	      (setq inputs (delq input inputs))
+	      (cond
+	       ((eq input 'date)
+		(setq date (mhc-input-day &quot;Date: &quot; current-date)))
+	       ((eq input 'time)
+		(setq time (mhc-input-time &quot;Time: &quot;)))
+	       ((eq input 'subject)
+		(setq subject (mhc-input-subject &quot;Subject: &quot;)))
+	       ((eq input 'location)
+		(setq location (mhc-input-location &quot;Location: &quot;)))
+	       ((eq input 'category)
+		(setq category (mhc-input-category &quot;Category: &quot;)))
+	       ((eq input 'alarm)
+		(if mhc-ask-alarm
+		    (setq alarm (mhc-input-alarm &quot;Alarm: &quot; mhc-default-alarm))))))))
       ;; Quit.
       (quit
        (and (interactive-p)
</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="02010" href="msg02010.html">[mhc:02011] Re: import &#x6642;&#x306E;&#x5165;&#x529B;&#x9806;&#x5E8F;&#x306B;&#x3064;&#x3044;&#x3066;</a></strong>
<ul><li><em>From:</em> NOGUCHI Yusuke</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="02008" href="msg02008.html">[mhc:02009] import &#x6642;&#x306E;&#x5165;&#x529B;&#x9806;&#x5E8F;&#x306B;&#x3064;&#x3044;&#x3066;</a></strong>
<ul><li><em>From:</em> NOGUCHI Yusuke</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg02008.html">[mhc:02009] import &#x6642;&#x306E;&#x5165;&#x529B;&#x9806;&#x5E8F;&#x306B;&#x3064;&#x3044;&#x3066;</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg02010.html">[mhc:02011] Re: import &#x6642;&#x306E;&#x5165;&#x529B;&#x9806;&#x5E8F;&#x306B;&#x3064;&#x3044;&#x3066;</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg02008.html">[mhc:02009] import &#x6642;&#x306E;&#x5165;&#x529B;&#x9806;&#x5E8F;&#x306B;&#x3064;&#x3044;&#x3066;</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg02010.html">[mhc:02011] Re: import &#x6642;&#x306E;&#x5165;&#x529B;&#x9806;&#x5E8F;&#x306B;&#x3064;&#x3044;&#x3066;</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#02009"><strong>Date</strong></a></li>
<li><a href="threads.html#02009"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
