<!-- MHonArc v2.6.16 -->
<!--X-Subject: [mhc:01386] Re: mhc&#45;import =?ISO&#45;2022&#45;JP?B?GyRCJE47fjlvGyhC?= guess =?ISO&#45;2022&#45;JP?B?GyRCJE5JVDZxOWcbKEI=?= -->
<!--X-From-R13: Kbfuvanev @bzhen <abzNpfpr.xlhfuh&#45;h.np.wc> -->
<!--X-Date: Mon, 25 Jun 2001 22:06:19 +0900 -->
<!--X-Message-Id: 20010625220619B.nom@csce.kyushu&#45;u.ac.jp -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 01Jun22.182923jst.29579@gateway.suri.co.jp -->
<!--X-Reference: 20010625144944N.nom@csce.kyushu&#45;u.ac.jp -->
<!--X-Reference: 01Jun25.171243jst.29572@gateway.suri.co.jp -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>[mhc:01386] Re: mhc-import &#x306E;&#x6642;&#x523B; guess &#x306E;&#x4E0D;&#x5177;&#x5408;</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg01384.html">Date Prev</a>][<a href="msg01386.html">Date Next</a>][<a href="msg01384.html">Thread Prev</a>][<a href="msg01387.html">Thread Next</a>][<a href="maillist.html#01385">Date Index</a>][<a href="threads.html#01385">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[mhc:01386] Re: mhc-import &#x306E;&#x6642;&#x523B; guess &#x306E;&#x4E0D;&#x5177;&#x5408;</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:mhc@DOMAIN.HIDDEN">mhc@xxxxxxxxxxxxx</a></li>
<li><em>Subject</em>: [mhc:01386] Re: mhc-import &#x306E;&#x6642;&#x523B; guess &#x306E;&#x4E0D;&#x5177;&#x5408;</li>
<li><em>From</em>: Yoshinari Nomura &lt;<a href="mailto:nom@DOMAIN.HIDDEN">nom@xxxxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Mon, 25 Jun 2001 22:06:19 +0900</li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:01Jun25.171243jst.29572@DOMAIN.HIDDEN">01Jun25.171243jst.29572@xxxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>References</em>: &lt;<a href="mailto:01Jun22.182923jst.29579@DOMAIN.HIDDEN">01Jun22.182923jst.29579@xxxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:20010625144944N.nom@DOMAIN.HIDDEN">20010625144944N.nom@xxxxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:01Jun25.171243jst.29572@DOMAIN.HIDDEN">01Jun25.171243jst.29572@xxxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Reply-to</em>: <a href="mailto:mhc@DOMAIN.HIDDEN">mhc@xxxxxxxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>&#x4E43;&#x6751;&#x3067;&#x3059;&#xFF0E;

On Mon, 25 Jun 2001 16:56:54 +0900,
	KOIE Hidetaka (&#x9BC9;&#x6C5F;&#x82F1;&#x9686;) &lt;hide@xxxxxxxx&gt; said:

&gt;     2001-06-23:01:02:03
&gt; 
&gt; &#x3068;&#x3044;&#x3046;&#x8150;&#x3063;&#x305F;&#x6587;&#x5B57;&#x5217;&#x304C;&#x3042;&#x3063;&#x305F;&#x5834;&#x5408;&#x3001;23:01&#x306E;&#x5019;&#x88DC;&#x3068;14:03&#x306E;&#x5019;&#x88DC;&#x304C;&#x51FA;&#x307E;&#x3059;&#x3002;
&gt; &#x3053;&#x308C;&#x3092;guess&#x3067;&#x304D;&#x308B;&#x5FC5;&#x8981;&#x306F;&#x306A;&#x3044;&#x306E;&#x3067;&#x3059;&#x304C;
&gt; &#x7591;&#x554F;
&gt;    (1) 01:02&#x304C;&#x51FA;&#x3066;&#x3053;&#x306A;&#x3044;
&gt;    (2) &#x306A;&#x305C;02:03&#x3067;&#x306F;&#x306A;&#x304F;&#x3066;14:03&#x306A;&#x306E;&#x304B;

(1) &#x306F;&#xFF0C;isearch-forward-regexp &#x3057;&#x3066;&#xFF0C;
[0-9]+:[0-9]+ &#x3068;&#x5165;&#x529B;&#x3057;&#x3066;&#xFF0C;C-s &#x3092;&#x9023;&#x6253;&#x3059;&#x308B;&#x3068;&#xFF0C;
01:02 &#x304C;&#x51FA;&#x3066;&#x3053;&#x306A;&#x3044;&#x306E;&#x3068;&#x540C;&#x3058;&#x7406;&#x7531;&#x3067;&#x3059;&#xFF0E;
&#x3053;&#x3044;&#x3064;&#x306F;&#xFF0C;&#x304A;&#x305D;&#x3089;&#x304F;&#x30DE;&#x30C3;&#x30C1;&#x3055;&#x305B;&#x308B;&#x5FC5;&#x8981;&#x306F;&#x306A;&#x3044;&#x3068;&#x601D;&#x3044;&#x307E;&#x3059;&#xFF0E;

(2) &#x306F;&#xFF0C;8&#x6642;&#x3088;&#x308A;&#x524D;&#x306B;&#x4E88;&#x5B9A;&#x304C;&#x5165;&#x3089;&#x306A;&#x3044;&#x3068;&#x8E0F;&#x3093;&#x3067;&#xFF0C;
08:00 &#x3088;&#x308A;&#x524D;&#x306E;&#x6642;&#x523B;&#x306F;&#xFF0C;&#x5348;&#x5F8C;&#x306B;&#x8AAD;&#x307F;&#x63DB;&#x3048;&#x3066;&#xFF0C;+12 &#x3057;&#x3066;&#x3044;&#x308B;
&#x304B;&#x3089;&#x3067;&#x3059;&#xFF0E;8 &#x306F;&#xFF0C;&#x50D5;&#x306E;&#x751F;&#x6D3B;&#x30B9;&#x30BF;&#x30A4;&#x30EB;&#x306B;&#x4F9D;&#x5B58;&#x3057;&#x3066;&#x3044;&#x3066;&#xFF0C;
&#x30BD;&#x30FC;&#x30B9;&#x4E2D;&#x306B;&#x3082;&#x30B3;&#x30E1;&#x30F3;&#x30C8;&#x3057;&#x3066;&#x3042;&#x308A;&#x307E;&#x3059;&#xFF0E;

&#x50D5;&#x306F;&#xFF0C;&#x3053;&#x308C;&#x304C;&#x5177;&#x5408;&#x304C;&#x3044;&#x3044;&#x306E;&#x3067;&#x3059;&#x304C;&#xFF0C;
&#x3053;&#x308C;&#x3067;&#x56F0;&#x3063;&#x305F;&#x3053;&#x3068;&#x3042;&#x308B;&#x4EBA;&#x304C;&#x3044;&#x307E;&#x3059;&#x304B;?
&#x3042;&#x308C;&#x3070;&#xFF0C;&#x30AB;&#x30B9;&#x30BF;&#x30DE;&#x30A4;&#x30BA;&#x53EF;&#x80FD;&#x306B;&#x3057;&#x307E;&#x3059;&#xFF0E;

&gt; &#x30B3;&#x30FC;&#x30C9;&#x307F;&#x3066;&#x3082;&#x3055;&#x3063;&#x3071;&#x308A;&#x306A;&#x306E;&#x3067;
&gt; &#x3053;&#x308C;&#x304C;&#x6F5C;&#x5728;&#x30D0;&#x30B0;&#x3092;&#x3064;&#x3063;&#x3064;&#x3044;&#x3066;&#x304F;&#x308C;&#x308B;&#x3053;&#x3068;&#x3092;&#x671F;&#x5F85;&#x3057;&#x3064;&#x3064;
&gt; &#x73FE;&#x8C61;&#x3060;&#x3051;&#x5831;&#x544A;&#x3055;&#x305B;&#x3066;&#x3044;&#x305F;&#x3060;&#x304D;&#x307E;&#x3059;&#x3002;

&#x3082;&#x3063;&#x3068;&#x3059;&#x3063;&#x304D;&#x308A;&#x66F8;&#x3051;&#x308C;&#x3070;&#x3044;&#x3044;&#x3093;&#x3067;&#x3059;&#x3051;&#x3069;&#xFF0E;&#xFF0E;&#xFF0E;

&#x6700;&#x5F8C;&#x306B;&#x304A;&#x307E;&#x3051;&#x3068;&#x3057;&#x3066;&#xFF0C;mhc-stat.el &#x3068;&#x3044;&#x3046;&#xFF0C;guess &#x306E;&#x6027;&#x80FD;&#x3092;&#x8A08;&#x308B;
&#x30C4;&#x30FC;&#x30EB;&#x3092;&#x4ED8;&#x3051;&#x307E;&#x3059;&#xFF0E;&#x4E0B;&#x8A18;&#x3092; eval &#x3057;&#x3066;&#x3082;&#x3089;&#x3063;&#x3066;&#xFF0C;*scratch* &#x306B;&#x79FB;&#x52D5;&#x3057;&#x3066;&#xFF0C;
M-x mhc-stat-guess-check &#x306B;&#xFF0C;&#x4F8B;&#x3048;&#x3070;&#xFF0C; ~nom/Mail/schedule/2001 &#x3068;
&#x7B54;&#x3048;&#x3066;&#x307F;&#x3066;&#x304F;&#x3060;&#x3055;&#x3044;&#xFF0E;

2001&#x5E74;&#x306E; guess &#x306B;&#x95A2;&#x3059;&#x308B;&#x5931;&#x6557;&#xFF0C;&#x6210;&#x529F;&#x306E;&#x69D8;&#x5B50;&#x304C;&#x5206;&#x304B;&#x308A;&#x307E;&#x3059;&#xFF0E;
&#x3067;&#xFF0C;&#x3082;&#x3057;&#x3088;&#x3051;&#x308C;&#x3070;&#xFF0C;&#x5931;&#x6557;&#x3059;&#x308B;&#x5178;&#x578B;&#x7684;&#x306A;&#x4F8B;&#x306B;&#x3064;&#x3044;&#x3066;&#xFF0C;
&#x307F;&#x306A;&#x3055;&#x3093;&#x306B;&#x30D5;&#x30A3;&#x30FC;&#x30C9;&#x30D0;&#x30C3;&#x30AF;&#x3057;&#x3066;&#x3044;&#x305F;&#x3051;&#x308C;&#x3070;&#x5B09;&#x3057;&#x3044;&#x3067;&#x3059;&#xFF0E;
--
nom

;;; mhc-stat.el -- Get statistics of MHC.

;; Author:  Yoshinari Nomura &lt;nom@xxxxxxxxxxxxx&gt;
;;
;; Created: 2001/06/25
;; Revised: $Date$
;;

;;;
;;; Commentary:
;;;

;; mhc-stat-guess reports the statistics of mhc-guess results.
;;
;;

;;;
;;; Code:
;;;

(require 'mhc-schedule)
(provide 'mhc-stat)

;; returns a path list in a directory recursively.
(defun mhc-stat/filename-recursively (dir &amp;optional pattern)
  (message &quot;Checking %s ... &quot; dir)
  (let* ((dir    (expand-file-name dir))
	 (dirent (delete &quot;..&quot; (delete &quot;.&quot; (directory-files dir))))
	 (ret    ()))
    (while dirent
      (setq path (expand-file-name (car dirent) dir))
      (cond
       ((and (file-regular-p  path)
	     (or (null pattern) (string-match pattern path)))
	(setq ret (cons path ret)))
       ((file-directory-p path)
	(setq ret (append (mhc-stat/filename-recursively path pattern) ret)))
       (t
	() ;; ignore
	))
      (setq dirent (cdr dirent)))
    (message &quot;Checking %s ... done.&quot; dir)
    ret))

;;
;; reports guess results and answers.
;;
;; Each MHC file contains original e-mail (Question) and
;; X-SC-Day: (Answer) both. Using this info, check the 
;; guess errors.
;;
;; return: (gues-result . answer)
;;
;; (nil          . &quot;1999-01-01&quot;) ... failed (guess has no idea)
;; (&quot;1999-01-31&quot; . &quot;1999-01-01&quot;) ... failed (guess mismatch)
;; (&quot;1999-01-01&quot; . &quot;1999-01-01&quot;) ... succeed
;; 'dont-care                    ... It is not inported article from a mail.
;; 'multi                        ... It contains multiple articles in a file.
;;
(defun mhc-stat/guess-check-one (filename)
  (let (sch guess)
    (save-excursion
      ;; setup buffer
      (set-buffer (mhc-get-buffer-create &quot; *mhc-parse-file*&quot;))
      (delete-region (point-min) (point-max))
      (mhc-insert-file-contents-as-coding-system
       mhc-default-coding-system filename)
      ;; guess.
      (if (setq guess (car (mhc-guess-date)))
	  (setq guess (mhc-guess-get-date guess)))

      ;; return answer and guess results.
      (if (not (mhc-header-get-value &quot;From&quot;))
	  'dont-care
	(setq sch (car (mhc-record-schedules
			(mhc-parse-buffer
			 (mhc-record-new filename)))))
	(if (mhc-logic-occur-multiple-p (mhc-schedule-condition sch))
	    'multi
	  (cons
	   (if guess (mhc-date-format guess &quot;%04d-%02d-%02d&quot; yy mm dd))
	   (mhc-date-format (car (aref (mhc-schedule-condition sch)  0))
			    &quot;%04d-%02d-%02d&quot; yy mm dd)))))))

;;
;; make guess report from a mhc directory.
;;
(defun mhc-stat-guess-check (dir)
  (interactive &quot;D&quot;)
  (let ((path-list (mhc-stat/filename-recursively dir &quot;/[0-9]+$&quot;))
	(nomail-count 0) (multi-count 0) (ok-count 0) (ng-count 0))

    (while path-list
      (message (format &quot;Checking %s ...&quot; path))
      (setq guess-result (mhc-stat/guess-check-one (car path-list)))
      (cond
       ((eq 'dont-care guess-result)
	(setq nomail-count (1+ nomail-count))
	(setq status &quot;NOMAIL&quot;))
       ((eq 'multi guess-result)
	(setq multi-count (1+ multi-count))
	(setq status &quot;MULTI&quot;))
       ((equal (car guess-result) (cdr guess-result))
	(setq ok-count (1+ ok-count))
	(setq status &quot;OK&quot;))
       (t
	(setq ng-count (1+ ng-count))
	(setq status &quot;NG&quot;)))

      (if (listp guess-result)
	  (insert (format &quot;%-6s guess: %10s ans: %10s %s\n&quot;
			  status
			  (car guess-result)
			  (cdr guess-result)
			  (car path-list)))
	(insert (format &quot;%-6s guess: %10s ans: %10s %s\n&quot;
			status &quot;&quot; &quot;&quot; (car path-list))))
      (setq path-list (cdr path-list)))
    (insert (format &quot;TOTAL:  OK: %d, NG: %d, NOMAIL: %d MULTI: %d\n&quot;
		    ok-count ng-count nomail-count multi-count))))

;;; Copyright Notice:

;; Copyright (C) 2001 Yoshinari Nomura. All rights reserved.
;; Copyright (C) 2001 MHC developing team. All rights reserved.

;; Redistribution and use in source and binary forms, with or without
;; modification, are permitted provided that the following conditions
;; are met:
;; 
;; 1. Redistributions of source code must retain the above copyright
;;    notice, this list of conditions and the following disclaimer.
;; 2. Redistributions in binary form must reproduce the above copyright
;;    notice, this list of conditions and the following disclaimer in the
;;    documentation and/or other materials provided with the distribution.
;; 3. Neither the name of the team nor the names of its contributors
;;    may be used to endorse or promote products derived from this software
;;    without specific prior written permission.
;; 
;; THIS SOFTWARE IS PROVIDED BY THE TEAM AND CONTRIBUTORS ``AS IS''
;; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
;; LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
;; FOR A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL
;; THE TEAM OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
;; INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
;; (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
;; SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
;; HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
;; STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
;; ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
;; OF THE POSSIBILITY OF SUCH DAMAGE.

;;; mhc-stat.el ends here
</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="01387" href="msg01387.html">[mhc:01388] Re: mhc-import &#x306E;&#x6642;&#x523B; guess &#x306E;&#x4E0D;&#x5177;&#x5408;</a></strong>
<ul><li><em>From:</em> &#x767D;&#x4E95;&#x79C0;&#x884C;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="01381" href="msg01381.html">[mhc:01382] mhc-import &#x306E;&#x6642;&#x523B; guess &#x306E;&#x4E0D;&#x5177;&#x5408;</a></strong>
<ul><li><em>From:</em> &#x9BC9;&#x6C5F;&#x82F1;&#x9686;</li></ul></li>
<li><strong><a name="01382" href="msg01382.html">[mhc:01383] Re: mhc-import &#x306E;&#x6642;&#x523B; guess &#x306E;&#x4E0D;&#x5177;&#x5408;</a></strong>
<ul><li><em>From:</em> Yoshinari Nomura</li></ul></li>
<li><strong><a name="01383" href="msg01383.html">[mhc:01384] Re: mhc-import &#x306E;&#x6642;&#x523B; guess &#x306E;&#x4E0D;&#x5177;&#x5408;</a></strong>
<ul><li><em>From:</em> &#x9BC9;&#x6C5F;&#x82F1;&#x9686;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg01384.html">[mhc:01385] Re: mhc-import &#x306E;&#x6642;&#x523B; guess &#x306E;&#x4E0D;&#x5177;&#x5408;</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg01386.html">[mhc:01387] mhc-current-snap20010625.tar.gz</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg01384.html">[mhc:01385] Re: mhc-import &#x306E;&#x6642;&#x523B; guess &#x306E;&#x4E0D;&#x5177;&#x5408;</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg01387.html">[mhc:01388] Re: mhc-import &#x306E;&#x6642;&#x523B; guess &#x306E;&#x4E0D;&#x5177;&#x5408;</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#01385"><strong>Date</strong></a></li>
<li><a href="threads.html#01385"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
