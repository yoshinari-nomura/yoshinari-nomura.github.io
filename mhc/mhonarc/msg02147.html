<!-- MHonArc v2.6.16 -->
<!--X-Subject: [mhc:02148] =?ISO&#45;2022&#45;JP?B?GyRCRTpJVRsoQg==?= vCalendar =?ISO&#45;2022&#45;JP?B?GyRCJE4bKEI=?= import -->
<!--X-From-R13: @AUGQVW Khfhxr <abthabthNzin.ovtybor.ar.wc> -->
<!--X-Date: Wed, 07 Sep 2005 19:00:35 +0900 (JST) -->
<!--X-Message-Id: 20050907.190035.82050715.nogunogu@mva.biglobe.ne.jp -->
<!--X-Content-Type: multipart/mixed -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>[mhc:02148] &#x6DFB;&#x4ED8; vCalendar &#x306E; import</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg02146.html">Date Prev</a>][<a href="msg02148.html">Date Next</a>][<a href="msg02145.html">Thread Prev</a>][<a href="msg02148.html">Thread Next</a>][<a href="maillist.html#02147">Date Index</a>][<a href="threads.html#02147">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[mhc:02148] &#x6DFB;&#x4ED8; vCalendar &#x306E; import</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:mhc@DOMAIN.HIDDEN">mhc@xxxxxxxxxxxxx</a></li>
<li><em>Subject</em>: [mhc:02148] &#x6DFB;&#x4ED8; vCalendar &#x306E; import</li>
<li><em>From</em>: NOGUCHI Yusuke &lt;<a href="mailto:nogunogu@DOMAIN.HIDDEN">nogunogu@xxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Wed, 07 Sep 2005 19:00:35 +0900 (JST)</li>
<li><em>Delivered-to</em>: <a href="mailto:mhc@DOMAIN.HIDDEN">mhc@xxxxxxxxxxxxx</a></li>
<li><em>List-help</em>: &lt;<a href="mailto:mhc-ctl@quickhack.net?body=help">mailto:mhc-ctl@quickhack.net?body=help</a>&gt;</li>
<li><em>List-id</em>: mhc.quickhack.net</li>
<li><em>List-owner</em>: &lt;<a href="mailto:mhc-admin@quickhack.net">mailto:mhc-admin@quickhack.net</a>&gt;</li>
<li><em>List-post</em>: &lt;<a href="mailto:mhc@quickhack.net">mailto:mhc@quickhack.net</a>&gt;</li>
<li><em>List-software</em>: fml [fml 4.0.3 release (20011202/4.0.3)]</li>
<li><em>List-unsubscribe</em>: &lt;<a href="mailto:mhc-ctl@quickhack.net?body=unsubscribe">mailto:mhc-ctl@quickhack.net?body=unsubscribe</a>&gt;</li>
<li><em>Reply-to</em>: <a href="mailto:mhc@DOMAIN.HIDDEN">mhc@xxxxxxxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>&#x91CE;&#x53E3;&#x3067;&#x3059;&#x3002;

PC &#x4E0A; mhc &#x306E;&#x30B9;&#x30B1;&#x30B8;&#x30E5;&#x30FC;&#x30EB;&#x3092;&#x3068;&#x624B;&#x6301;&#x3061;&#x306E; au &#x30B1;&#x30FC;&#x30BF;&#x30A4; (W21CAII) &#x306E;&#x30B9;&#x30B1;&#x30B8;&#x30E5;&#x30FC;
&#x30E9;&#x3092;&#x9023;&#x643A;&#x3057;&#x3066;&#x4F7F;&#x3044;&#x305F;&#x3044;&#x3068;&#x601D;&#x3063;&#x3066;&#x3044;&#x307E;&#x3059;&#x3002;
# PDA&#x3088;&#x308A;&#x8EFD;&#x304F;&#x3066;&#x3001;&#x643A;&#x5E2F;&#x3059;&#x308B;&#x306E;&#x306B;&#x90AA;&#x9B54;&#x306B;&#x306A;&#x3089;&#x306A;&#x3044;&#x305F;&#x3081;&#x3002;

mhc -&gt; W21CAII &#x65B9;&#x5411;&#x306E;&#x30A8;&#x30AF;&#x30B9;&#x30DD;&#x30FC;&#x30C8;&#x306F;&#x7279;&#x306B;&#x554F;&#x984C;&#x306F;&#x306A;&#x304F;

  mhc-&gt;(mhc2ol)-&gt;outlook&lt;=&gt;(&#x540C;&#x671F;&#x30C4;&#x30FC;&#x30EB;(&#x203B;1))&lt;=&gt;W21CAII 
(&#x203B;1) <a  rel="nofollow" href="http://www.mysync.jp/">http://www.mysync.jp/</a> &#x7B49;&#x306E;&#x58F2;&#x308A;&#x7269;

&#x3067;&#x884C;&#x3063;&#x3066;&#x3044;&#x307E;&#x3059;&#x3002;
&#x5927;&#x534A;&#x306F;&#x3053;&#x306E;&#x65B9;&#x5411;&#x306A;&#x306E;&#x3067;&#x3059;&#x304C;&#x3001;&#x7A00;&#x306B;&#x5916;&#x51FA;&#x5148;&#x3067;&#x30B9;&#x30B1;&#x30B8;&#x30E5;&#x30FC;&#x30EB;&#x304C;&#x6C7A;&#x307E;&#x308B;&#x3053;&#x3068;&#x304C;&#x3042;&#x308A;&#x307E;&#x3059;&#x3002;
&#x305D;&#x306E;&#x3088;&#x3046;&#x306A;&#x5834;&#x5408;&#x306F;&#x3001;&#x3068;&#x308A;&#x3042;&#x3048;&#x305A; W21CAII &#x306E;&#x30B9;&#x30B1;&#x30B8;&#x30E5;&#x30FC;&#x30E9;&#x306B;&#x76F4;&#x63A5;&#x30B9;&#x30B1;&#x30B8;&#x30E5;&#x30FC;&#x30EB;
&#x3092;&#x767B;&#x9332;&#x3059;&#x308B;&#x306E;&#x3067;&#x3059;&#x304C;&#x3001;&#x3053;&#x306E;&#x300C;W21CAII &#x3067;&#x767B;&#x9332;&#x3057;&#x305F;&#x30B9;&#x30B1;&#x30B8;&#x30E5;&#x30FC;&#x30EB;&#x3092;&#x3001;&#x306A;&#x308B;&#x3079;&#x304F;&#x697D;
&#x306B; mhc &#x3078;&#x6301;&#x3063;&#x3066;&#x3044;&#x304D;&#x305F;&#x3044;&#x300D;&#x3068;&#x601D;&#x3063;&#x3066;&#x3044;&#x307E;&#x3059;&#x3002;

&#x5177;&#x5408;&#x306E;&#x826F;&#x3044;&#x3053;&#x3068;&#x306B;&#x3001;W21CAII &#x306B;&#x306F;&#x300C;&#x30B9;&#x30B1;&#x30B8;&#x30E5;&#x30FC;&#x30EB;&#x60C5;&#x5831;&#x3092; vCalendar &#x5F62;&#x5F0F;&#x306E;&#x6DFB;
&#x4ED8;&#x30D5;&#x30A1;&#x30A4;&#x30EB;&#x306B;&#x3057;&#x3066;&#x3001;Email &#x3067;&#x9001;&#x4FE1;&#x3059;&#x308B;&#x300D;&#x3068;&#x3044;&#x3046;&#x6A5F;&#x80FD;&#x304C;&#x3042;&#x308A;&#x3001;&#x3053;&#x308C;&#x3092;&#x5229;&#x7528;&#x3057;&#x3088;&#x3046;
&#x3068;&#x8003;&#x3048;&#x307E;&#x3057;&#x305F;&#x3002;

&#x305D;&#x3053;&#x3067;&#x3001;&#x6DFB;&#x4ED8; mhc-vcalendar.el &#x306E;&#x3088;&#x3046;&#x306A;&#x3082;&#x306E;&#x3092;&#x4F5C;&#x3063;&#x3066;&#x307F;&#x305F;&#x306E;&#x3067;&#x3059;&#x304C;&#x3001;&#x4F55;&#x70B9;&#x304B;
&#x81EA;&#x529B;&#x3067;&#x306F;&#x89E3;&#x6C7A;&#x3067;&#x304D;&#x306A;&#x3044;&#x554F;&#x984C;&#x304C;&#x3042;&#x308A;&#x3001;&#x884C;&#x304D;&#x3065;&#x307E;&#x3063;&#x3066;&#x3057;&#x307E;&#x3044;&#x307E;&#x3057;&#x305F;&#x3002;
&#x3088;&#x308D;&#x3057;&#x3051;&#x308C;&#x3070;&#x3001;&#x30A2;&#x30C9;&#x30D0;&#x30A4;&#x30B9;&#x3092;&#x3044;&#x305F;&#x3060;&#x3051;&#x306A;&#x3044;&#x3067;&#x3057;&#x3087;&#x3046;&#x304B;&#x3002;

(1) &#x672C;&#x6765;&#x306F;&#x3001;&#x901A;&#x5E38;&#x306E; import &#x540C;&#x69D8;&#x306B;&#x3001; C-c . | (mhc-import) &#x3067;&#x3068;&#x308A;&#x3053;&#x3080;&#x3088;&#x3046;
    &#x306B;&#x3057;&#x305F;&#x304B;&#x3063;&#x305F;&#x306E;&#x3067;&#x3059;&#x304C;&#x3001;mhc-default-import-original-article &#x304C; nil &#x306E;
    &#x72B6;&#x614B;&#x3067;&#x306F;&#x3001;guess &#x306E;&#x6A5F;&#x69CB;&#x304C;&#x307E;&#x3063;&#x305F;&#x304F;&#x50CD;&#x3044;&#x3066;&#x304F;&#x308C;&#x307E;&#x305B;&#x3093;&#x3002;
    vCalendar &#x30C7;&#x30FC;&#x30BF;&#x304C; base64 &#x306B;&#x30A8;&#x30F3;&#x30B3;&#x30FC;&#x30C9;&#x3057;&#x3066;&#x6DFB;&#x4ED8;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#x3053;&#x3068;&#x95A2;&#x4FC2;&#x304C;
    &#x3042;&#x308B;&#x304B;&#x3068;&#x601D;&#x3063;&#x3066;&#x3044;&#x308B;&#x306E;&#x3067;&#x3059;&#x304C;&#x3001;&#x3088;&#x304F;&#x308F;&#x304B;&#x308A;&#x307E;&#x305B;&#x3093;&#x3002;
    &#x66AB;&#x5B9A;&#x51E6;&#x7F6E;&#x3068;&#x3057;&#x3066; vCalendar &#x306E;&#x53D6;&#x308A;&#x8FBC;&#x307F;&#x6642;&#x3060;&#x3051;&#x3001;&#x4E00;&#x6642;&#x7684;&#x306B;
    mhc-default-import-original-article =t &#x3068;&#x3059;&#x308B; wrapper &#x95A2;&#x6570;&#x3092;&#x4F5C;&#x308A;&#x307E;
    &#x3057;&#x305F;&#x3002;
    (&#x79C1;&#x306E;&#x901A;&#x5E38;&#x306E;&#x4F7F;&#x3044;&#x65B9;&#x306F;&#x3001;mhc-default-import-original-article =nil &#x306A;&#x306E;&#x3067;)
 
(2) (1) &#x3067;&#x53D6;&#x308A;&#x8FBC;&#x3093;&#x3060; mhc &#x306E;&#x30B9;&#x30B1;&#x30B8;&#x30E5;&#x30FC;&#x30EB;(vCalendar&#x304C;&#x6DFB;&#x4ED8;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;)&#x3092;&#x3001;
    &#x53C2;&#x7167;&#x3057;&#x3088;&#x3046;&#x3068;&#x3059;&#x308B;&#x3068;&#x3001;&#x6B63;&#x3057;&#x304F;&#x8868;&#x793A;&#x3055;&#x308C;&#x307E;&#x305B;&#x3093;&#x3002;
    W21CAII &#x304B;&#x3089;&#x9001;&#x4FE1;&#x3057;&#x305F;&#x3082;&#x306E;(&#x672C;&#x30E1;&#x30FC;&#x30EB;&#x306B;&#x6DFB;&#x4ED8;)&#x306F; base64 &#x3067;&#x30A8;&#x30F3;&#x30B3;&#x30FC;&#x30C7;&#x30A3;&#x30F3;
    &#x30B0;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#x305F;&#x3081;
Content-Transfer-Encoding: base64
    &#x304C;&#x4ED8;&#x3044;&#x3066;&#x3044;&#x307E;&#x3059;&#x3002;
    mhc-default-import-original-article =t &#x3067;&#x3068;&#x308A;&#x3053;&#x3093;&#x3060;&#x30E1;&#x30FC;&#x30EB;&#x306F;&#x3001; mhc &#x306B;
    &#x3068;&#x308A;&#x3053;&#x3093;&#x3060;&#x6642;&#x70B9;&#x3067;&#x6DFB;&#x4ED8;&#x90E8;&#x5206;&#x304C;&#x30C7;&#x30B3;&#x30FC;&#x30C9;&#x3055;&#x308C;&#x308B;&#x3088;&#x3046;&#x306A;&#x306E;&#x3067;&#x3059;&#x304C;&#x3001;
Content-Transfer-Encoding: base64
    &#x304C;&#x305D;&#x306E;&#x307E;&#x307E;&#x6B8B;&#x3063;&#x3066;&#x3044;&#x308B;&#x305F;&#x3081;&#x3001;&#x5F62;&#x5F0F;&#x304C;&#x4E00;&#x81F4;&#x305B;&#x305A;&#x8868;&#x793A;&#x304C;&#x3067;&#x304D;&#x306A;&#x3044;&#x3088;&#x3046;&#x3067;&#x3059;&#x3002;

    &#x2192; &#x6DFB;&#x4ED8;&#x90E8;&#x5206;&#x306E;&quot;Content-Transfer-Encoding: base64&quot;&#x3092;&#x81EA;&#x52D5;&#x3067;&#x524A;&#x308B;&#x306B;&#x306F;
       &#x3069;&#x3046;&#x3057;&#x305F;&#x3089;&#x826F;&#x3044;&#x3067;&#x3057;&#x3087;&#x3046;&#x304B;&#xFF1F;
       &#x307E;&#x305F;&#x306F;&#x3001;&#x518D;&#x5EA6; base64 &#x30A8;&#x30F3;&#x30B3;&#x30FC;&#x30C7;&#x30A3;&#x30F3;&#x30B0;&#x3057;&#x3066;&#x767B;&#x9332;&#x3059;&#x308B;&#x65B9;&#x6CD5;&#x3067;&#x3082;&#x826F;&#x3044;
       &#x3067;&#x3059;&#x3002;(&#x77DB;&#x76FE;&#x3055;&#x3048;&#x3057;&#x306A;&#x3051;&#x308C;&#x3070;OK&#x306A;&#x306E;&#x3067;)

(3) &#x81EA;&#x4F5C;&#x306E;&#x6B63;&#x898F;&#x8868;&#x73FE;&#x3067;&#x3001;&#x3068;&#x308A;&#x3042;&#x3048;&#x305A; date, time, location &#x3092; vCalendar &#x30C7;&#x30FC;
    &#x30BF;&#x304B;&#x3089; guess &#x306F;&#x3067;&#x304D;&#x308B;&#x3088;&#x3046;&#x306B;&#x306F;&#x306A;&#x3063;&#x305F;&#x306E;&#x3067;&#x3059;&#x304C;...
    location &#x306B;&#x3064;&#x3044;&#x3066;&#x306F;&#x3001;&#x300C;&#x5185;&#x5BB9;&#x300D;&#x304C; 
LOCATION;ENCODING=QUOTED-PRINTABLE:=83e=83X=83g=89=EF=8F=EA
    &#x3068;&#x30A8;&#x30F3;&#x30B3;&#x30FC;&#x30C9;&#x3055;&#x308C;&#x305F;&#x5F62;&#x3067;&#x9001;&#x3089;&#x308C;&#x3066;&#x304D;&#x307E;&#x3059;&#x3002;
    &#x73FE;&#x5728;&#x3001;&#x3053;&#x306E;&#x90E8;&#x5206;&#x3092;&#x30C7;&#x30B3;&#x30FC;&#x30C9;&#x3059;&#x308B;&#x65B9;&#x6CD5;&#x304C;&#x3088;&#x304F;&#x308F;&#x304B;&#x3089;&#x305A;&#x3001;
    &quot;=83e=83X=83g=89=EF=8F=EA&quot; &#x304C;&#x305D;&#x306E;&#x307E;&#x307E;&#x767B;&#x9332;&#x3055;&#x308C;&#x3066;&#x3057;&#x307E;&#x3044;&#x307E;&#x3059;&#x3002;
    &#x72D9;&#x3044;&#x3068;&#x3057;&#x3066;&#x306F;&#x3001;&#x73FE;&#x5728;

(setq mhc-guess-location-regexp-list
:
    (,(concat &quot;\\(LOCATION\\)[;]?\\(ENCODING=[A-z-_]*\\)?:\\(.*\\)&quot;)
     mhc-guess/make-location-from-string 3)))

   &#x3068;&#x306A;&#x3063;&#x3066;&#x3044;&#x308B;&#x500B;&#x6240;&#x3067;&#x3001;
       (mhc-guess/make-location-from-string-cs STRING CODING-SYSTEM)
   &#x306E;&#x3088;&#x3046;&#x306A;&#x30C7;&#x30B3;&#x30FC;&#x30C9;&#x95A2;&#x6570;(&#x65B0;&#x898F;&#x306B;&#x5B9A;&#x7FA9;)&#x306B;&#x6E21;&#x3057;&#x3066;&#x3084;&#x308A;&#x305F;&#x3044;&#x3068;&#x601D;&#x3063;&#x3066;&#x3044;&#x308B;&#x306E;&#x3067;&#x3059;
   &#x304C;&#x3001;&#x30C7;&#x30B3;&#x30FC;&#x30C9;&#x65B9;&#x6CD5;&#x304C;&#x3088;&#x304F;&#x5206;&#x3089;&#x305A;&#x3001;&#x9813;&#x632B;&#x3057;&#x3066;&#x3044;&#x307E;&#x3059;&#x3002;
   Outlook &#x306B;&#x3068;&#x308A;&#x3053;&#x307E;&#x305B;&#x308B;&#x3068;&#x3001;&#x6B63;&#x3057;&#x304F;&#x65E5;&#x672C;&#x8A9E;&#x8868;&#x8A18;&#x306B;&#x306A;&#x308A;&#x307E;&#x3059;&#x306E;&#x3067;&#x3001;&#x30C7;&#x30FC;&#x30BF;&#x5F62;
   &#x5F0F;&#x304C;&#x4E0D;&#x6B63;&#x3068;&#x3044;&#x3046;&#x3053;&#x3068;&#x306F;&#x306A;&#x3055;&#x305D;&#x3046;&#x3067;&#x3059;&#x3002;
   &#x3061;&#x306A;&#x307F;&#x306B;&#x3001;&#x6DFB;&#x4ED8; vCalendar &#x3067;&#x30A8;&#x30F3;&#x30B3;&#x30FC;&#x30C9;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#x500B;&#x6240;&#x306E;&#x5185;&#x5BB9;&#x306F;&#x3001;&#x305D;&#x308C;&#x305E;&#x308C;
   &#x4EE5;&#x4E0B;&#x306E;&#x901A;&#x308A;&#x3067;&#x3059;&#x3002;

SUMMARY;ENCODING=QUOTED-PRINTABLE:=83e=83X=83g
  &#x2192; &#x30C6;&#x30B9;&#x30C8;
LOCATION;ENCODING=QUOTED-PRINTABLE:=83e=83X=83g=89=EF=8F=EA
  &#x2192; &#x30C6;&#x30B9;&#x30C8;&#x4F1A;&#x5834;
DESCRIPTION;ENCODING=QUOTED-PRINTABLE:=83e=83X=83g=83X=83P=83W=83=85=81[=
=83=8B
  &#x2192; &#x30C6;&#x30B9;&#x30C8;&#x30B9;&#x30B1;&#x30B8;&#x30E5;&#x30FC;&#x30EB;

&#x4EE5;&#x4E0A;&#x3001;&#x53C2;&#x8003;&#x60C5;&#x5831;&#x3078;&#x306E;&#x30DD;&#x30A4;&#x30F3;&#x30BF;&#x7B49;&#x3092;&#x5FA1;&#x5B58;&#x77E5;&#x306E;&#x65B9;&#x304C;&#x3044;&#x3089;&#x3063;&#x3057;&#x3083;&#x3044;&#x307E;&#x3057;&#x305F;&#x3089;&#x3001;&#x30A2;&#x30C9;&#x30D0;
&#x30A4;&#x30B9;&#x3044;&#x305F;&#x3060;&#x3051;&#x307E;&#x3059;&#x3067;&#x3057;&#x3087;&#x3046;&#x304B;&#xFF1F;
&#x3088;&#x308D;&#x3057;&#x304F;&#x304A;&#x9858;&#x3044;&#x3044;&#x305F;&#x3057;&#x307E;&#x3059;&#x3002;

P.S.
&#x6DFB;&#x4ED8;&#x306E; mhc-vcalendar.el &#x3092;&#x4F7F;&#x3046;&#x306B;&#x306F;&#x3001;&#x3042;&#x3089;&#x304B;&#x3058;&#x3081; mhc-*-setup() &#x304C;&#x5B9F;&#x884C;&#x3055;
&#x308C;&#x305F;&#x72B6;&#x614B;&#x306B;&#x306A;&#x3063;&#x305F;&#x4E0A;&#x3067;&#x3001;load-file() &#x7B49;&#x3067;&#x3088;&#x307F;&#x3053;&#x307E;&#x306A;&#x3044;&#x3068;&#x52D5;&#x4F5C;&#x3057;&#x307E;&#x305B;&#x3093;&#x3002;
(&#x307E;&#x3060;&#x3001;Prototype&#x3067;&#x3059;&#x306E;&#x3067;)

-- 
NOGUCHI Yusuke &lt;nogunogu@xxxxxxxxxxxxxxxxx&gt;
</pre><pre>;;; mhc-vcalendar.el
;;; 
;;; Prototype 2005/09/02

;;; User I/F
(defun mhc-import-vcalendar (&amp;optional get-original)
  &quot;Wrapper function of mhc-import() for importing vCalendar.&quot;
  (interactive
   (let (mhc-default-import-original-article-org)
     (setq mhc-default-import-original-article-org mhc-default-import-original-article)
     (unwind-protect
	 (progn
	   (setq mhc-default-import-original-article t)
	   (list (if mhc-default-import-original-article 
		     (not current-prefix-arg)
		   current-prefix-arg)))
       (setq mhc-default-import-original-article mhc-default-import-original-article-org))))
  (mhc-window-push)
  (unless (mhc-edit (mhc-summary-get-import-buffer get-original))
    ;; failed.
    (mhc-window-pop)))

;;; guess Location

;; (push
;;  (,(concat &quot;\\(LOCATION\\)[;]?\\(ENCODING=[A-z-_]*\\)?:\\(.*\\)&quot;)
;;   mhc-guess/make-location-from-string 3)
;;  mhc-guess-location-regexp-list)

;; re-define (mhc-guess.el)
(setq mhc-guess-location-regexp-list
  `(
    (,(concat &quot;[&#x4F1A; &#x3000;]*&#x5834;[ &#x3000;]*&#x6240;[ &#x3000;]*[&#xFF1A;:]*[\n &#x3000;]*\\([^\n &#x3000;]+\\)&quot;)
     mhc-guess/make-location-from-string 1)
    (,(concat &quot;&#x65BC;[ &#x3000;]*\\([^\n &#x3000;]+\\)&quot;)
     mhc-guess/make-location-from-string 1)
    (,(concat &quot;[@&#xFF20;][&#x3000; ]*\\([^\n&#x3000; .]+\\)[&#x3000; \n]&quot;)
     mhc-guess/make-location-from-string 1)
    (,(concat &quot;\\(LOCATION\\)[;]?\\(ENCODING=[A-z-_]*\\)?:\\(.*\\)&quot;)
     mhc-guess/make-location-from-string 3)))

(mhc-guess-location-setup)


;;; guess date
(setq mhc-guess-date-iso8601-regexp-list
      `(
	(,(concat &quot;\\(DTSTART:\\)&quot;
		  &quot;\\([0-9][0-9][0-9][0-9]\\)\\([0-9][0-9]\\)\\([0-9][0-9]\\)&quot;
		  &quot;\\(T\\)?\\([0-9]*\\)\\(Z\\)?[\n]?&quot;
		  &quot;\\(DTEND:\\)&quot;
		  &quot;\\([0-9][0-9][0-9][0-9]\\)\\([0-9][0-9]\\)\\([0-9][0-9]\\)&quot;)
	 mhc-guess/make-date-from-yyyymmdd 2 3 4 9 10 11)))

;; re-define (mhc-guess.el)
(defun mhc-guess-date (&amp;optional hint1)
  (let ((now (or (mhc-date-new-from-string3 (mhc-header-get-value &quot;Date&quot;))
		 (mhc-date-now))))
    (mhc-guess/guess
     (if mhc-guess-ignore-english-date
	 (list mhc-guess-date-regexp-list)
       (list mhc-guess-date-regexp-list mhc-guess-date-english-regexp-list
	     mhc-guess-date-iso8601-regexp-list))
     hint1 now)))


;;; guess time
(defvar mhc-guess-time-iso8601-regexp-list
  `(
    (,(concat &quot;\\(DTSTART:\\)\\([0-9]*\\)T&quot;
	      &quot;\\([0-9][0-9]\\)\\([0-9][0-9]\\)\\([0-9][0-9]\\)&quot;
	      &quot;\\(Z\\)&quot;
	      &quot;\\([\n]\\)\\(DTEND:\\)\\([0-9]*\\)T&quot;
	      &quot;\\([0-9][0-9]\\)\\([0-9][0-9]\\)\\([0-9][0-9]\\)&quot;
	      &quot;\\(Z\\)?&quot;
	      )
     mhc-guess/make-time-from-hhmm-with-tz 3 4 6 10 11 13)
    ))

(defun mhc-guess/make-time-from-hhmm-with-tz
  (now hh-str mm-str tz1 hh-str2 mm-str2 tz2 &amp;optional relative)
  (let ((now (current-time-string))
	time-list start	end)
    (setq time-list 
	  (mhc-guess/make-time-from-hhmm now hh-str mm-str hh-str2 mm-str2 relative))
    (setq start (car time-list))
    (setq end (cdr time-list))
    (if (and start tz1)
	(setq start (mhc-time+ start (/ (car (current-time-zone)) 60))))
    (if (and end tz2)
	(setq end (mhc-time+ end (/ (car (current-time-zone)) 60))))
    (cons start end)))

;; re-define (mhc-guess.el)
(defun mhc-guess-time (&amp;optional hint1)
  (mhc-guess/guess (list mhc-guess-time-regexp-list
			 mhc-guess-time-iso8601-regexp-list) hint1))

</pre><blockquote><small>---&nbsp;<i>Begin&nbsp;Message</i>&nbsp;---</small>
<ul>
<li><em>To</em>: <a href="mailto:noguchi@DOMAIN.HIDDEN">noguchi@xxxxxxxxxxxx</a></li>
<li><em>Subject</em>: &#x30C6;&#x30B9;&#x30C8;&#x30B9;&#x30B1;&#x30B8;&#x30E5;&#x30FC;&#x30EB;</li>
<li><em>From</em>: <a href="mailto:noguchi.yusuke@DOMAIN.HIDDEN">noguchi.yusuke@xxxxxxxxxxx</a></li>
<li><em>Date</em>: Sat, 3 Sep 2005 10:53:17 +0900</li>
</ul>
<pre>&#x30B9;&#x30B1;&#x30B8;&#x30E5;&#x30FC;&#x30EB;&#x3067;&#x3059;
</pre><pre>BEGIN:VCALENDAR
VERSION:1.0
BEGIN:VEVENT
CLASS:PUBLIC
DTSTART:20050907T104000Z
DTEND:20050908T114000Z
AALARM:20050907T103500Z
SUMMARY;ENCODING=QUOTED-PRINTABLE:=83e=83X=83g
CATEGORIES:BUSINESS
LOCATION;ENCODING=QUOTED-PRINTABLE:=83e=83X=83g=89=EF=8F=EA
DESCRIPTION;ENCODING=QUOTED-PRINTABLE:=83e=83X=83g=83X=83P=83W=83=85=81[=
=83=8B
LAST-MODIFIED:20050907T015129Z
END:VEVENT
END:VCALENDAR
</pre><br><small>---&nbsp;<i>End Message</i>&nbsp;---</small></blockquote>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="02148" href="msg02148.html">[mhc:02149] Re: &#x6DFB;&#x4ED8; vCalendar &#x306E; import</a></strong>
<ul><li><em>From:</em> &#x767D;&#x4E95;&#x79C0;&#x884C;</li></ul></li>
<li><strong><a name="02149" href="msg02149.html">[mhc:02150] Re: &#x6DFB;&#x4ED8; vCalendar &#x306E; import</a></strong>
<ul><li><em>From:</em> Yoshinari Nomura</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg02146.html">[mhc:02147] Re: palm2mhc should fsync before clear dirty flag.</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg02148.html">[mhc:02149] Re: &#x6DFB;&#x4ED8; vCalendar &#x306E; import</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg02145.html">[mhc:02146] patch (mhc-guess.el)</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg02148.html">[mhc:02149] Re: &#x6DFB;&#x4ED8; vCalendar &#x306E; import</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#02147"><strong>Date</strong></a></li>
<li><a href="threads.html#02147"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
